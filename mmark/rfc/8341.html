<!DOCTYPE html>
<html lang="en" class="RFC">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>RFC 8341: Network Configuration Access Control Model</title>
<meta content="Andy Bierman" name="author">
<meta content="Martin Bjorklund" name="author">
<meta content="
       The standardization of network configuration interfaces for use with the Network Configuration
Protocol (NETCONF) or the RESTCONF protocol requires a structured and secure operating environment
that promotes human usability and multi-vendor interoperability.  There is a need for standard
mechanisms to restrict NETCONF or RESTCONF protocol access for particular users to a preconfigured
subset of all available NETCONF or RESTCONF protocol operations and content.  This document defines
such an access control model. 
       This document obsoletes RFC 6536. 
    " name="description">
<meta content="xml2rfc 2.44.0" name="generator">
<meta content="8341" name="rfc.number">
<link href="8341.xml" type="application/rfc+xml" rel="alternate">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}</style>
<link href="rfc-local.css" type="text/css" rel="stylesheet">
<link href="https://datatracker.ietf.org/doc/8341" rel="prev">
  <link href="https://dx.doi.org/10.17487/rfc8341" rel="alternate">
  <link href="urn:issn:2070-1721" rel="alternate">
  </head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">RFC 8341</td>
<td class="center">NACM</td>
<td class="right">March 2018</td>
</tr></thead>
<tfoot><tr>
<td class="left">Bierman &amp; Bjorklund</td>
<td class="center">Standards Track</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-stream">Stream:</dt>
<dd class="stream">Internet Engineering Task Force (IETF)</dd>
<dt class="label-rfc">RFC:</dt>
<dd class="rfc"><a href="https://www.rfc-editor.org/rfc/rfc8341" class="eref">8341</a></dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc6536" class="eref">6536</a> </dd>
<dt class="label-category">Category:</dt>
<dd class="category">Standards Track</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2018-03-01" class="published">1 March 2018</time>
    </dd>
<dt class="label-issn">ISSN:</dt>
<dd class="issn">2070-1721</dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Bierman</div>
<div class="org">YumaWorks</div>
</div>
<div class="author">
      <div class="author-name">M. Bjorklund</div>
<div class="org">Tail-f Systems</div>
</div>
</dd>
</dl>
</div>
<h1 id="rfcnum">RFC 8341</h1>
<h1 id="title">Network Configuration Access Control Model</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The standardization of network configuration interfaces for use with the Network Configuration
Protocol (NETCONF) or the RESTCONF protocol requires a structured and secure operating environment
that promotes human usability and multi-vendor interoperability.  There is a need for standard
mechanisms to restrict NETCONF or RESTCONF protocol access for particular users to a preconfigured
subset of all available NETCONF or RESTCONF protocol operations and content.  This document defines
such an access control model.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document obsoletes RFC 6536.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
            This is an Internet Standards Track document.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
            This document is a product of the Internet Engineering Task Force
            (IETF).  It represents the consensus of the IETF community.  It has
            received public review and has been approved for publication by
            the Internet Engineering Steering Group (IESG).  Further
            information on Internet Standards is available in Section 2 of 
            RFC 7841.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
            Information about the current status of this document, any
            errata, and how to provide feedback on it may be obtained at
            <span><a href="https://www.rfc-editor.org/info/rfc8341">https://www.rfc-editor.org/info/rfc8341</a></span>.<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2018 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-changes-since-rfc-6536" class="xref">Changes since RFC 6536</a><a href="#section-toc.1-1.1.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-access-control-design-objec" class="xref">Access Control Design Objectives</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-access-control-points" class="xref">Access Control Points</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-simplicity" class="xref">Simplicity</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-procedural-interface" class="xref">Procedural Interface</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-datastore-access" class="xref">Datastore Access</a><a href="#section-toc.1-1.2.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="xref">2.5</a>.  <a href="#name-users-and-groups" class="xref">Users and Groups</a><a href="#section-toc.1-1.2.2.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a href="#section-2.6" class="xref">2.6</a>.  <a href="#name-maintenance" class="xref">Maintenance</a><a href="#section-toc.1-1.2.2.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.7">
                <p id="section-toc.1-1.2.2.7.1"><a href="#section-2.7" class="xref">2.7</a>.  <a href="#name-configuration-capabilities" class="xref">Configuration Capabilities</a><a href="#section-toc.1-1.2.2.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.8">
                <p id="section-toc.1-1.2.2.8.1"><a href="#section-2.8" class="xref">2.8</a>.  <a href="#name-identifying-security-sensit" class="xref">Identifying Security-Sensitive Content</a><a href="#section-toc.1-1.2.2.8.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-netconf-access-control-mode" class="xref">NETCONF Access Control Model (NACM)</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-overview" class="xref">Overview</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="xref">3.1.1</a>.  <a href="#name-features" class="xref">Features</a><a href="#section-toc.1-1.3.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="xref">3.1.2</a>.  <a href="#name-external-dependencies" class="xref">External Dependencies</a><a href="#section-toc.1-1.3.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="xref">3.1.3</a>.  <a href="#name-message-processing-model" class="xref">Message Processing Model</a><a href="#section-toc.1-1.3.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-datastore-access-2" class="xref">Datastore Access</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="xref">3.2.1</a>.  <a href="#name-mapping-new-datastores-to-n" class="xref">Mapping New Datastores to NACM</a><a href="#section-toc.1-1.3.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="xref">3.2.2</a>.  <a href="#name-access-rights" class="xref">Access Rights</a><a href="#section-toc.1-1.3.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a href="#section-3.2.3" class="xref">3.2.3</a>.  <a href="#name-restconf-methods" class="xref">RESTCONF Methods</a><a href="#section-toc.1-1.3.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2.2.4">
                    <p id="section-toc.1-1.3.2.2.2.4.1"><a href="#section-3.2.4" class="xref">3.2.4</a>.  <a href="#name-get-and-get-config-operatio" class="xref">&lt;get&gt; and &lt;get-config&gt; Operations</a><a href="#section-toc.1-1.3.2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2.2.5">
                    <p id="section-toc.1-1.3.2.2.2.5.1"><a href="#section-3.2.5" class="xref">3.2.5</a>.  <a href="#name-edit-config-operation" class="xref">&lt;edit-config&gt; Operation</a><a href="#section-toc.1-1.3.2.2.2.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2.2.6">
                    <p id="section-toc.1-1.3.2.2.2.6.1"><a href="#section-3.2.6" class="xref">3.2.6</a>.  <a href="#name-copy-config-operation" class="xref">&lt;copy-config&gt; Operation</a><a href="#section-toc.1-1.3.2.2.2.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2.2.7">
                    <p id="section-toc.1-1.3.2.2.2.7.1"><a href="#section-3.2.7" class="xref">3.2.7</a>.  <a href="#name-delete-config-operation" class="xref">&lt;delete-config&gt; Operation</a><a href="#section-toc.1-1.3.2.2.2.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2.2.8">
                    <p id="section-toc.1-1.3.2.2.2.8.1"><a href="#section-3.2.8" class="xref">3.2.8</a>.  <a href="#name-commit-operation" class="xref">&lt;commit&gt; Operation</a><a href="#section-toc.1-1.3.2.2.2.8.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2.2.9">
                    <p id="section-toc.1-1.3.2.2.2.9.1"><a href="#section-3.2.9" class="xref">3.2.9</a>.  <a href="#name-discard-changes-operation" class="xref">&lt;discard-changes&gt; Operation</a><a href="#section-toc.1-1.3.2.2.2.9.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2.2.10">
                    <p id="section-toc.1-1.3.2.2.2.10.1"><a href="#section-3.2.10" class="xref">3.2.10</a>. <a href="#name-kill-session-operation" class="xref">&lt;kill-session&gt; Operation</a><a href="#section-toc.1-1.3.2.2.2.10.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-model-components" class="xref">Model Components</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="xref">3.3.1</a>.  <a href="#name-users" class="xref">Users</a><a href="#section-toc.1-1.3.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="xref">3.3.2</a>.  <a href="#name-groups" class="xref">Groups</a><a href="#section-toc.1-1.3.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.3.2.3">
                    <p id="section-toc.1-1.3.2.3.2.3.1"><a href="#section-3.3.3" class="xref">3.3.3</a>.  <a href="#name-emergency-recovery-session" class="xref">Emergency Recovery Session</a><a href="#section-toc.1-1.3.2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.3.2.4">
                    <p id="section-toc.1-1.3.2.3.2.4.1"><a href="#section-3.3.4" class="xref">3.3.4</a>.  <a href="#name-global-enforcement-controls" class="xref">Global Enforcement Controls</a><a href="#section-toc.1-1.3.2.3.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.3.2.5">
                    <p id="section-toc.1-1.3.2.3.2.5.1"><a href="#section-3.3.5" class="xref">3.3.5</a>.  <a href="#name-access-control-rules" class="xref">Access Control Rules</a><a href="#section-toc.1-1.3.2.3.2.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-access-control-enforcement-" class="xref">Access Control Enforcement Procedures</a><a href="#section-toc.1-1.3.2.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="xref">3.4.1</a>.  <a href="#name-initial-operation" class="xref">Initial Operation</a><a href="#section-toc.1-1.3.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="xref">3.4.2</a>.  <a href="#name-session-establishment" class="xref">Session Establishment</a><a href="#section-toc.1-1.3.2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.4.2.3">
                    <p id="section-toc.1-1.3.2.4.2.3.1"><a href="#section-3.4.3" class="xref">3.4.3</a>.  <a href="#name-access-denied-error-handlin" class="xref">"access-denied" Error Handling</a><a href="#section-toc.1-1.3.2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.4.2.4">
                    <p id="section-toc.1-1.3.2.4.2.4.1"><a href="#section-3.4.4" class="xref">3.4.4</a>.  <a href="#name-incoming-rpc-message-valida" class="xref">Incoming RPC Message Validation</a><a href="#section-toc.1-1.3.2.4.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.4.2.5">
                    <p id="section-toc.1-1.3.2.4.2.5.1"><a href="#section-3.4.5" class="xref">3.4.5</a>.  <a href="#name-data-node-access-validation" class="xref">Data Node Access Validation</a><a href="#section-toc.1-1.3.2.4.2.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.4.2.6">
                    <p id="section-toc.1-1.3.2.4.2.6.1"><a href="#section-3.4.6" class="xref">3.4.6</a>.  <a href="#name-outgoing-notification-autho" class="xref">Outgoing &lt;notification&gt; Authorization</a><a href="#section-toc.1-1.3.2.4.2.6.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-data-model-definitions" class="xref">Data Model Definitions</a><a href="#section-toc.1-1.3.2.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a href="#section-3.5.1" class="xref">3.5.1</a>.  <a href="#name-data-organization" class="xref">Data Organization</a><a href="#section-toc.1-1.3.2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.5.2.2">
                    <p id="section-toc.1-1.3.2.5.2.2.1"><a href="#section-3.5.2" class="xref">3.5.2</a>.  <a href="#name-yang-module" class="xref">YANG Module</a><a href="#section-toc.1-1.3.2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-nacm-configuration-and-moni" class="xref">NACM Configuration and Monitoring Considerations</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-general-configuration-issue" class="xref">General Configuration Issues</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-data-model-design-considera" class="xref">Data Model Design Considerations</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-usage-examples" class="xref">Usage Examples</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.  <a href="#name-groups-example" class="xref">&lt;groups&gt; Example</a><a href="#section-toc.1-1.8.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-a.2" class="xref">A.2</a>.  <a href="#name-module-rule-example" class="xref">Module Rule Example</a><a href="#section-toc.1-1.8.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-a.3" class="xref">A.3</a>.  <a href="#name-protocol-operation-rule-exa" class="xref">Protocol Operation Rule Example</a><a href="#section-toc.1-1.8.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-a.4" class="xref">A.4</a>.  <a href="#name-data-node-rule-example" class="xref">Data Node Rule Example</a><a href="#section-toc.1-1.8.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8.2.5">
                <p id="section-toc.1-1.8.2.5.1"><a href="#section-a.5" class="xref">A.5</a>.  <a href="#name-notification-rule-example" class="xref">Notification Rule Example</a><a href="#section-toc.1-1.8.2.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The Network Configuration Protocol (NETCONF) and the RESTCONF protocol do not provide any standard
mechanisms to restrict the protocol operations and content that each user is authorized to access.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">There is a need for interoperable management of the controlled access to administrator-selected
portions of the available NETCONF or RESTCONF content within a particular server.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document addresses access control mechanisms for the Operations and Content layers of NETCONF,
as defined in <span>[<a href="#RFC6241" class="xref">RFC6241</a>]</span>; and RESTCONF, as defined in <span>[<a href="#RFC8040" class="xref">RFC8040</a>]</span>.  It contains three main
sections:<a href="#section-1-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-1-4">
        <li id="section-1-4.1">
          <p id="section-1-4.1.1">Access Control Design Objectives<a href="#section-1-4.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1-4.2">
          <p id="section-1-4.2.1">NETCONF Access Control Model (NACM)<a href="#section-1-4.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1-4.3">
          <p id="section-1-4.3.1">YANG Data Model (ietf-netconf-acm.yang)<a href="#section-1-4.3.1" class="pilcrow">¶</a></p>
</li>
</ol>
<p id="section-1-5">YANG version 1.1 <span>[<a href="#RFC7950" class="xref">RFC7950</a>]</span> adds two new constructs that need special access control handling.  The
"action" statement is similar to the "rpc" statement, except that it is located within a data node.
The "notification" statement can also be located within a data node.<a href="#section-1-5" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>",
"<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this
document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when,
they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">The following terms are defined in <span>[<a href="#RFC8342" class="xref">RFC8342</a>]</span> and are not redefined
here:<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-1.1-3.1">
            <p id="section-1.1-3.1.1">datastore<a href="#section-1.1-3.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1.1-3.2">
            <p id="section-1.1-3.2.1">configuration datastore<a href="#section-1.1-3.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1.1-3.3">
            <p id="section-1.1-3.3.1">conventional configuration datastore<a href="#section-1.1-3.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1.1-3.4">
            <p id="section-1.1-3.4.1">candidate configuration datastore<a href="#section-1.1-3.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1.1-3.5">
            <p id="section-1.1-3.5.1">running configuration datastore<a href="#section-1.1-3.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1.1-3.6">
            <p id="section-1.1-3.6.1">startup configuration datastore<a href="#section-1.1-3.6.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1.1-3.7">
            <p id="section-1.1-3.7.1">operational state datastore<a href="#section-1.1-3.7.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1.1-3.8">
            <p id="section-1.1-3.8.1">client<a href="#section-1.1-3.8.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1.1-3.9">
            <p id="section-1.1-3.9.1">server<a href="#section-1.1-3.9.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-1.1-4">The following terms are defined in <span>[<a href="#RFC6241" class="xref">RFC6241</a>]</span> and are not redefined here:<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-1.1-5.1">
            <p id="section-1.1-5.1.1">protocol operation<a href="#section-1.1-5.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1.1-5.2">
            <p id="section-1.1-5.2.1">session<a href="#section-1.1-5.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1.1-5.3">
            <p id="section-1.1-5.3.1">user<a href="#section-1.1-5.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-1.1-6">The following terms are defined in <span>[<a href="#RFC7950" class="xref">RFC7950</a>]</span> and are not redefined here:<a href="#section-1.1-6" class="pilcrow">¶</a></p>
<ul>
<li id="section-1.1-7.1">
            <p id="section-1.1-7.1.1">action<a href="#section-1.1-7.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1.1-7.2">
            <p id="section-1.1-7.2.1">data node<a href="#section-1.1-7.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1.1-7.3">
            <p id="section-1.1-7.3.1">data definition statement<a href="#section-1.1-7.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-1.1-8">The following terms are defined in <span>[<a href="#RFC8040" class="xref">RFC8040</a>]</span> and are not redefined here:<a href="#section-1.1-8" class="pilcrow">¶</a></p>
<ul>
<li id="section-1.1-9.1">
            <p id="section-1.1-9.1.1">data resource<a href="#section-1.1-9.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1.1-9.2">
            <p id="section-1.1-9.2.1">datastore resource<a href="#section-1.1-9.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1.1-9.3">
            <p id="section-1.1-9.3.1">operation resource<a href="#section-1.1-9.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-1.1-9.4">
            <p id="section-1.1-9.4.1">target resource<a href="#section-1.1-9.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-1.1-10">The following term is defined in <span>[<a href="#RFC7230" class="xref">RFC7230</a>]</span> and is not redefined here:<a href="#section-1.1-10" class="pilcrow">¶</a></p>
<ul>
<li id="section-1.1-11.1">
            <p id="section-1.1-11.1.1">request URI<a href="#section-1.1-11.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-1.1-12">The following terms are used throughout this document:<a href="#section-1.1-12" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-1.1-13">
          <dt id="section-1.1-13.1">access control:</dt>
<dd id="section-1.1-13.2">
            <p id="section-1.1-13.2.1">A security feature provided by the server that allows an administrator to restrict access to
a subset of all protocol operations and data, based on various criteria.<a href="#section-1.1-13.2.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-1.1-13.3">access control model (ACM):</dt>
<dd id="section-1.1-13.4">
            <p id="section-1.1-13.4.1">A conceptual model used to configure and monitor the access control procedures desired by the
administrator to enforce a particular access control policy.<a href="#section-1.1-13.4.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-1.1-13.5">access control rule:</dt>
<dd id="section-1.1-13.6">
            <p id="section-1.1-13.6.1">The criterion used to determine if a particular access operation will be permitted or denied.<a href="#section-1.1-13.6.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-1.1-13.7">access operation:</dt>
<dd id="section-1.1-13.8">
            <p id="section-1.1-13.8.1">How a request attempts to access a conceptual object.  One of "none", "read", "create",
"delete", "update", or "execute".<a href="#section-1.1-13.8.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-1.1-13.9">data node hierarchy:</dt>
<dd id="section-1.1-13.10">
            <p id="section-1.1-13.10.1">The hierarchy of data nodes that identifies the specific "action" or "notification" node in the
datastore.<a href="#section-1.1-13.10.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-1.1-13.11">recovery session:</dt>
<dd id="section-1.1-13.12">
            <p id="section-1.1-13.12.1">A special administrative session that is given unlimited NETCONF access and is exempt from all
access control enforcement.  The mechanism or mechanisms used by a server to control and
identify whether or not a session is a recovery session are implementation specific and are
outside the scope of this document.<a href="#section-1.1-13.12.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-1.1-13.13">write access:</dt>
<dd id="section-1.1-13.14">
            <p id="section-1.1-13.14.1">A shorthand for the "create", "delete", and "update" access operations.<a href="#section-1.1-13.14.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="changes-since-rfc-6536">
<section id="section-1.2">
        <h3 id="name-changes-since-rfc-6536">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-changes-since-rfc-6536" class="section-name selfRef">Changes since RFC 6536</a>
        </h3>
<p id="section-1.2-1">The NACM procedures and data model have been updated to support new data modeling capabilities in
version 1.1 of the YANG data modeling language.  The "action" and "notification" statements can be
used within data nodes to define data-model-specific operations and notifications.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">An important use case for these new YANG statements is the increased access control granularity that
can be achieved over top-level "rpc" and "notification" statements.  The new "action" and
"notification" statements are used within data nodes, and access to the action or notification can
be restricted to specific instances of these data nodes.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3">Support for the RESTCONF protocol has been added.  The RESTCONF operations are similar to the
NETCONF operations, so a simple mapping to the existing NACM procedures and data model is possible.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<p id="section-1.2-4">The data node access behavior for path matches has been clarified to
also include matching descendant nodes of the specified path.<a href="#section-1.2-4" class="pilcrow">¶</a></p>
<p id="section-1.2-5">The &lt;edit-config&gt; operation access rights behavior has been clarified
to indicate that write access is not required for data nodes that are
implicitly modified through side effects (such as the evaluation of
YANG when-stmts, or data nodes implicitly deleted when creating a
data node under a different branch under a YANG choice-stmt).<a href="#section-1.2-5" class="pilcrow">¶</a></p>
<p id="section-1.2-6">The Security Considerations section has been updated to comply with the "YANG module security
guidelines" <span>[<a href="#YANG-SEC" class="xref">YANG-SEC</a>]</span>.  Note that the YANG module in this document does not define any RPC
operations.<a href="#section-1.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="access-control-design-objectives">
<section id="section-2">
      <h2 id="name-access-control-design-objec">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-access-control-design-objec" class="section-name selfRef">Access Control Design Objectives</a>
      </h2>
<p id="section-2-1">This section documents the design objectives for the NETCONF access
control model presented in <a href="#netconf-access-control-model-nacm" class="xref">Section 3</a>.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="access-control-points">
<section id="section-2.1">
        <h3 id="name-access-control-points">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-access-control-points" class="section-name selfRef">Access Control Points</a>
        </h3>
<p id="section-2.1-1">NETCONF allows server implementers to add new custom protocol operations, and the YANG data modeling
language supports this feature.  These operations can be defined in standard or proprietary YANG
modules.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">It is not possible to design an ACM for NETCONF that only focuses on a static set of standard
protocol operations defined by NETCONF itself, like some other protocols.  Since few assumptions can
be made about an arbitrary protocol operation, the NETCONF architectural server components need to
be protected at three conceptual control points.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">These access control points, described in <a href="#fig1" class="xref">Section 2.1</a>, are as follows:<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-2.1-4">
          <dt id="section-2.1-4.1">protocol operation:</dt>
<dd id="section-2.1-4.2">
            <p id="section-2.1-4.2.1">Permission to invoke specific protocol operations.<a href="#section-2.1-4.2.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-2.1-4.3">datastore:</dt>
<dd id="section-2.1-4.4">
            <p id="section-2.1-4.4.1">Permission to read and/or alter specific data nodes within any datastore.<a href="#section-2.1-4.4.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-2.1-4.5">notification:</dt>
<dd id="section-2.1-4.6">
            <p id="section-2.1-4.6.1">Permission to receive specific notification event types.<a href="#section-2.1-4.6.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
</dl>
<div id="fig1">
<div class="artwork art-text alignLeft" id="section-2.1-5">
<pre>                 +-------------+                 +-------------+
    client       |  protocol   |                 |  data node  |
    request --&gt;  |  operation  | -------------&gt;  |   access    |
                 |  allowed?   |   datastore     |  allowed?   |
                 +-------------+   or state      +-------------+
                                   data access


                 +----------------+
                 |  notification  |
    event --&gt;    |  allowed?      |
                 +----------------+
</pre><a href="#section-2.1-5" class="pilcrow">¶</a>
</div>
</div>
</section>
</div>
<div id="simplicity">
<section id="section-2.2">
        <h3 id="name-simplicity">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-simplicity" class="section-name selfRef">Simplicity</a>
        </h3>
<p id="section-2.2-1">There is concern that a complicated ACM will not be widely deployed
because it is too hard to use.  Configuration of the access control
system needs to be as simple as possible.  Simple and common tasks
need to be easy to configure and require little expertise or
domain-specific knowledge.  Complex tasks are possible using
additional mechanisms that may require additional expertise.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">A single set of access control rules ought to be able to control all
types of NETCONF protocol operation invocation, all datastore access,
and all notification events.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">Access control ought to be defined with a small and familiar set of
permissions, while still allowing full control of datastore access.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="procedural-interface">
<section id="section-2.3">
        <h3 id="name-procedural-interface">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-procedural-interface" class="section-name selfRef">Procedural Interface</a>
        </h3>
<p id="section-2.3-1">NETCONF uses a Remote Procedure Call (RPC) model and an extensible set of protocol operations.
Access control for any possible protocol operation is necessary.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="datastore-access">
<section id="section-2.4">
        <h3 id="name-datastore-access">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-datastore-access" class="section-name selfRef">Datastore Access</a>
        </h3>
<p id="section-2.4-1">It is necessary to control access to specific nodes and subtrees within the datastore, regardless of
which protocol operation -- standard or proprietary -- was used to access the datastore.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="users-and-groups">
<section id="section-2.5">
        <h3 id="name-users-and-groups">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-users-and-groups" class="section-name selfRef">Users and Groups</a>
        </h3>
<p id="section-2.5-1">It is necessary that access control rules for a single user or a configurable group of users can be
configured.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<p id="section-2.5-2">The ACM needs to support the concept of administrative groups, to support the well-established
distinction between a root account and other types of less-privileged conceptual user accounts.
These groups need to be configurable by the administrator.<a href="#section-2.5-2" class="pilcrow">¶</a></p>
<p id="section-2.5-3">It is necessary that the user-to-group mapping can be delegated to a central server, such as
a RADIUS server <span>[<a href="#RFC2865" class="xref">RFC2865</a>]</span> <span>[<a href="#RFC5607" class="xref">RFC5607</a>]</span>.  Since authentication is performed by the transport layer
and RADIUS performs authentication and service authorization at the same time, the underlying
transport protocol needs to be able to report a set of group names associated with the user to the
server.  It is necessary that the administrator can disable the usage of these group names within
the ACM.<a href="#section-2.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="maintenance">
<section id="section-2.6">
        <h3 id="name-maintenance">
<a href="#section-2.6" class="section-number selfRef">2.6. </a><a href="#name-maintenance" class="section-name selfRef">Maintenance</a>
        </h3>
<p id="section-2.6-1">It ought to be possible to disable part or all of the access control model enforcement procedures
without deleting any access control rules.<a href="#section-2.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="configuration-capabilities">
<section id="section-2.7">
        <h3 id="name-configuration-capabilities">
<a href="#section-2.7" class="section-number selfRef">2.7. </a><a href="#name-configuration-capabilities" class="section-name selfRef">Configuration Capabilities</a>
        </h3>
<p id="section-2.7-1">Suitable configuration and monitoring mechanisms are needed to allow an administrator to easily
manage all aspects of the ACM's behavior. A standard data model, suitable for use with the
&lt;edit-config&gt; protocol operation, needs to be available for this purpose.<a href="#section-2.7-1" class="pilcrow">¶</a></p>
<p id="section-2.7-2">Access control rules to restrict access operations on specific subtrees within the configuration
datastore need to be supported.<a href="#section-2.7-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="identifying-security-sensitive-content">
<section id="section-2.8">
        <h3 id="name-identifying-security-sensit">
<a href="#section-2.8" class="section-number selfRef">2.8. </a><a href="#name-identifying-security-sensit" class="section-name selfRef">Identifying Security-Sensitive Content</a>
        </h3>
<p id="section-2.8-1">One of the most important aspects of the data model documentation, and one of the biggest concerns
during deployment, is the identification of security-sensitive content.  This applies to protocol
operations in NETCONF, not just data and notifications.<a href="#section-2.8-1" class="pilcrow">¶</a></p>
<p id="section-2.8-2">It is mandatory for security-sensitive objects to be documented in the Security Considerations
section of an RFC.  This is nice, but it is not good enough, for the following reasons:<a href="#section-2.8-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-2.8-3.1">
            <p id="section-2.8-3.1.1">This documentation-only approach forces administrators to study the RFC and determine if there are
any potential security risks introduced by a new data model.<a href="#section-2.8-3.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-2.8-3.2">
            <p id="section-2.8-3.2.1">If any security risks are identified, then the administrator must study some more RFC text and
determine how to mitigate the security risk(s).<a href="#section-2.8-3.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-2.8-3.3">
            <p id="section-2.8-3.3.1">The ACM on each server must be configured to mitigate the security risks, e.g., require privileged
access to read or write the specific data identified in the Security Considerations section.<a href="#section-2.8-3.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-2.8-3.4">
            <p id="section-2.8-3.4.1">If the ACM is not preconfigured, then there will be a time window of vulnerability after the new
data model is loaded and before the new access control rules for that data model are configured,
enabled, and debugged.<a href="#section-2.8-3.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-2.8-4">Often, the administrator just wants to disable default access to the secure content so that no
inadvertent or malicious changes can be made to the server.  This allows the default rules to be
more lenient, without significantly increasing the security risk.<a href="#section-2.8-4" class="pilcrow">¶</a></p>
<p id="section-2.8-5">A data model designer needs to be able to use machine-readable statements to identify content that
needs to be protected by default. This will allow client and server tools to automatically identify
data-model-specific security risks, by denying access to sensitive data unless the user is
explicitly authorized to perform the requested access operation.<a href="#section-2.8-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="netconf-access-control-model-nacm">
<section id="section-3">
      <h2 id="name-netconf-access-control-mode">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-netconf-access-control-mode" class="section-name selfRef">NETCONF Access Control Model (NACM)</a>
      </h2>
<div id="overview">
<section id="section-3.1">
        <h3 id="name-overview">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-3.1-1">This section provides a high-level overview of the access control model structure.  It describes the
NETCONF protocol message processing model and the conceptual access control requirements within that
model.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div id="features">
<section id="section-3.1.1">
          <h4 id="name-features">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-features" class="section-name selfRef">Features</a>
          </h4>
<p id="section-3.1.1-1">The NACM data model provides the following features:<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.1.1-2.1">
              <p id="section-3.1.1-2.1.1">Independent control of RPC, action, data, and notification access is provided.<a href="#section-3.1.1-2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.1.1-2.2">
              <p id="section-3.1.1-2.2.1">The concept of an emergency recovery session is supported, but configuration of the server for
this purpose is beyond the scope of this document.  An emergency recovery session will bypass all
access control enforcement, in order to allow it to initialize or repair the NACM configuration.<a href="#section-3.1.1-2.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.1.1-2.3">
              <p id="section-3.1.1-2.3.1">A simple and familiar set of datastore permissions is used.<a href="#section-3.1.1-2.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.1.1-2.4">
              <p id="section-3.1.1-2.4.1">Support for YANG security tagging (e.g., a "nacm:default-deny-write" statement) allows default
security modes to automatically exclude sensitive data.<a href="#section-3.1.1-2.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.1.1-2.5">
              <p id="section-3.1.1-2.5.1">Separate default access modes for read, write, and execute permissions are provided.<a href="#section-3.1.1-2.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.1.1-2.6">
              <p id="section-3.1.1-2.6.1">Access control rules are applied to configurable groups of users.<a href="#section-3.1.1-2.6.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.1.1-2.7">
              <p id="section-3.1.1-2.7.1">The access control enforcement procedures can be disabled during operation, without deleting any
access control rules, in order to debug operational problems.<a href="#section-3.1.1-2.7.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.1.1-2.8">
              <p id="section-3.1.1-2.8.1">The number of denied protocol operation requests and denied datastore write requests can be
monitored by the client.<a href="#section-3.1.1-2.8.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.1.1-2.9">
              <p id="section-3.1.1-2.9.1">Simple unconstrained YANG instance-identifiers are used to configure access control rules for
specific data nodes.<a href="#section-3.1.1-2.9.1" class="pilcrow">¶</a></p>
</li>
</ul>
</section>
</div>
<div id="external-dependencies">
<section id="section-3.1.2">
          <h4 id="name-external-dependencies">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-external-dependencies" class="section-name selfRef">External Dependencies</a>
          </h4>
<p id="section-3.1.2-1">NETCONF <span>[<a href="#RFC6241" class="xref">RFC6241</a>]</span> and RESTCONF <span>[<a href="#RFC8040" class="xref">RFC8040</a>]</span> are used for network management purposes within this
document.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2-2">The YANG data modeling language <span>[<a href="#RFC7950" class="xref">RFC7950</a>]</span> is used to define the data models for use with NETCONF
or RESTCONF.  YANG is also used to define the data model in this document.<a href="#section-3.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="message-processing-model">
<section id="section-3.1.3">
          <h4 id="name-message-processing-model">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-message-processing-model" class="section-name selfRef">Message Processing Model</a>
          </h4>
<p id="section-3.1.3-1">The following diagram shows the conceptual message flow model, including the points at which access
control is applied during NETCONF message processing.<a href="#section-3.1.3-1" class="pilcrow">¶</a></p>
<p id="section-3.1.3-2">RESTCONF operations are mapped to the access control model based on the HTTP method and resource
class used in the operation.  For example, a POST method on a data resource is considered "write
data node" access, but a POST method on an operation resource is considered "operation" access.<a href="#section-3.1.3-2" class="pilcrow">¶</a></p>
<p id="section-3.1.3-3">The new "pre-read data node acc. ctl" boxes in the diagram below refer to group read access as it
relates to data node ancestors of an action or notification.  As an example, if an action is defined
as /interfaces/interface/reset-interface, the group must be authorized to (1) read /interfaces and
/interfaces/interface and (2) execute on /interfaces/interface/reset-interface.<a href="#section-3.1.3-3" class="pilcrow">¶</a></p>
<div id="fig2">
<div class="artwork art-text alignLeft" id="section-3.1.3-4">
<pre>            +-------------------------+
            |       session           |
            |      (username)         |
            +-------------------------+
               |                 ^
               V                 |
     +--------------+     +---------------+
     |   message    |     |   message     |
     | dispatcher   |     |   generator   |
     +--------------+     +---------------+
       |      |               ^         ^
       |      V               |         |
       |  +=============+     |         |
       |  | pre-read    |     |         |
       |  | data node   |     |         |
       |  | acc. ctl    |     |         |
       |  +=============+     |         |
       |    |                 |         |
       V    V                 |         |
 +===========+     +-------------+   +----------------+
 | operation |---&gt; |    reply    |   | &lt;notification&gt; |
 | acc. ctl  |     |  generator  |   |  generator     |
 +===========+     +-------------+   +----------------+
       |              ^    ^                ^
       V       +------+    |                |
 +-----------+ |   +=============+  +================+
 | operation | |   |    read     |  | &lt;notification&gt; |
 | processor |-+   | data node   |  |  access ctl    |
 |           |     | acc. ctl    |  |                |
 +-----------+     +=============+  +================+
       |   |                  ^       ^     ^
       V   +----------------+ |       |     |
 +===========+              | |       | +============+
 |  write    |              | |       | | pre-read   |
 | data node |              | |       | | data node  |
 | acc. ctl  | -----------+ | |       | | acc. ctl   |
 +===========+            | | |       | +============+
       |                  | | |       |   ^
       V                  V V |       |   |
 +---------------+      +-------------------+
 | configuration | ---&gt; |      server       |
 |   datastore   |      |  instrumentation  |
 |               | &lt;--- |                   |
 +---------------+      +-------------------+
</pre><a href="#section-3.1.3-4" class="pilcrow">¶</a>
</div>
</div>
<p id="section-3.1.3-5">The following high-level sequence of conceptual processing steps is executed for each received &lt;rpc&gt;
message, if access control enforcement is enabled:<a href="#section-3.1.3-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.1.3-6.1">
              <p id="section-3.1.3-6.1.1">For each active session, access control is applied individually to all &lt;rpc&gt; messages (except
&lt;close-session&gt;) received by the server, unless the session is identified as a recovery session.<a href="#section-3.1.3-6.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.1.3-6.2">
              <p id="section-3.1.3-6.2.1">If the &lt;action&gt; operation defined in <span>[<a href="#RFC7950" class="xref">RFC7950</a>]</span> is invoked, then read access is required for all
instances in the hierarchy of data nodes that identifies the specific action in the datastore, and
execute access is required for the action node.  If the user is not authorized to read all the
specified data nodes and execute the action, then the request is rejected with an "access-denied"
error.<a href="#section-3.1.3-6.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.1.3-6.3">
              <p id="section-3.1.3-6.3.1">Otherwise, if the user is not authorized to execute the specified protocol operation, then the
request is rejected with an "access-denied" error.<a href="#section-3.1.3-6.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.1.3-6.4">
              <p id="section-3.1.3-6.4.1">If a datastore is accessed by the protocol operation, then the server checks to see if the client
is authorized to access the nodes in the datastore.  If the user is not authorized to perform the
requested access operation on the requested data, then the request is rejected with an
"access-denied" error.<a href="#section-3.1.3-6.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.1.3-7">The following sequence of conceptual processing steps is executed for each generated notification
event, if access control enforcement is enabled:<a href="#section-3.1.3-7" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.1.3-8.1">
              <p id="section-3.1.3-8.1.1">Server instrumentation generates a notification for a particular subscription.<a href="#section-3.1.3-8.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.1.3-8.2">
              <p id="section-3.1.3-8.2.1">If the "notification" statement is specified within a data subtree, as specified in [RFC7950],
then read access is required for all instances in the hierarchy of data nodes that identifies the
specific notification in the datastore, and read access is required for the notification node.  If
the user is not authorized to read all the specified data nodes and the notification node, then
the notification is dropped for that subscription.<a href="#section-3.1.3-8.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.1.3-8.3">
              <p id="section-3.1.3-8.3.1">If the "notification" statement is a top-level statement, the notification access control enforcer
checks the notification event type, and if it is one that the user is not authorized to read, then
the notification is dropped for that subscription.<a href="#section-3.1.3-8.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</section>
</div>
</section>
</div>
<div id="datastore-access-1">
<section id="section-3.2">
        <h3 id="name-datastore-access-2">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-datastore-access-2" class="section-name selfRef">Datastore Access</a>
        </h3>
<p id="section-3.2-1">The same access control rules apply to all datastores that support the NACM -- for example, the
candidate configuration datastore or the running configuration datastore.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">All conventional configuration datastores and the operational state datastore are controlled by the
NACM.  Local files, remote files, or datastores accessed via the &lt;url&gt; parameter are not controlled
by the NACM.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<div id="mapping-new-datastores-to-nacm">
<section id="section-3.2.1">
          <h4 id="name-mapping-new-datastores-to-n">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-mapping-new-datastores-to-n" class="section-name selfRef">Mapping New Datastores to NACM</a>
          </h4>
<p id="section-3.2.1-1">It is possible that new datastores will be defined over time for use with NETCONF.  The NACM MAY be
applied to other datastores that have similar access rights as defined in the NACM.  To apply the
NACM to a new datastore, the new datastore specification needs to define how it maps to the NACM
CRUDX (Create, Read, Update, Delete, eXec) access rights.  It is possible that only a subset of the
NACM access rights would be applicable.  For example, only retrieval access control would be needed
for a read-only datastore.  Operations and access rights not supported by the NACM CRUDX model are
outside the scope of this document.  A datastore does not need to use the NACM, e.g., the datastore
specification defines something else or does not use access control.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="access-rights">
<section id="section-3.2.2">
          <h4 id="name-access-rights">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-access-rights" class="section-name selfRef">Access Rights</a>
          </h4>
<p id="section-3.2.2-1">A small set of hard-wired datastore access rights is needed to control access to all possible
protocol operations, including vendor extensions to the standard protocol operation set.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">The CRUDX model can support all protocol operations:<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.2.2-3.1">
              <p id="section-3.2.2-3.1.1">Create: allows the client to add a new data node instance to a datastore.<a href="#section-3.2.2-3.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.2.2-3.2">
              <p id="section-3.2.2-3.2.1">Read: allows the client to read a data node instance from a datastore or receive the notification
event type.<a href="#section-3.2.2-3.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.2.2-3.3">
              <p id="section-3.2.2-3.3.1">Update: allows the client to update an existing data node instance in a datastore.<a href="#section-3.2.2-3.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.2.2-3.4">
              <p id="section-3.2.2-3.4.1">Delete: allows the client to delete a data node instance from a datastore.<a href="#section-3.2.2-3.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.2.2-3.5">
              <p id="section-3.2.2-3.5.1">eXec: allows the client to execute the operation.<a href="#section-3.2.2-3.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
</section>
</div>
<div id="restconf-methods">
<section id="section-3.2.3">
          <h4 id="name-restconf-methods">
<a href="#section-3.2.3" class="section-number selfRef">3.2.3. </a><a href="#name-restconf-methods" class="section-name selfRef">RESTCONF Methods</a>
          </h4>
<p id="section-3.2.3-1">The RESTCONF protocol utilizes HTTP methods to perform datastore operations, similar to NETCONF.
The NACM procedures were originally written for NETCONF protocol operations, so the RESTCONF methods
are mapped to NETCONF operations for the purpose of access control processing.  The enforcement
procedures described within this document apply to both protocols unless explicitly stated
otherwise.<a href="#section-3.2.3-1" class="pilcrow">¶</a></p>
<p id="section-3.2.3-2">The request URI needs to be considered when processing RESTCONF requests on data resources:<a href="#section-3.2.3-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.2.3-3.1">
              <p id="section-3.2.3-3.1.1">For HEAD and GET requests, any data nodes that are ancestor nodes of the target resource are
considered to be part of the retrieval request for access control purposes.<a href="#section-3.2.3-3.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.2.3-3.2">
              <p id="section-3.2.3-3.2.1">For PUT, PATCH, and DELETE requests, any data nodes that are ancestor nodes of the target resource
are not considered to be part of the edit request for access control purposes.  The access
operation for these nodes is considered to be "none".  The edit begins at the target resource.<a href="#section-3.2.3-3.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.2.3-3.3">
              <p id="section-3.2.3-3.3.1">For POST requests on data resources, any data nodes that are specified in the request URI,
including the target resource, are not considered to be part of the edit request for access
control purposes.  The access operation for these nodes is considered to be "none".  The edit
begins at a child node of the target resource, specified in the message body.<a href="#section-3.2.3-3.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-3.2.3-4">Not all RESTCONF methods are subject to access control.  The following table specifies how each
method is mapped to NETCONF protocol operations.  The value "none" indicates that the NACM is not
applied at all to the specific RESTCONF method.<a href="#section-3.2.3-4" class="pilcrow">¶</a></p>
<span id="name-mapping-restconf-methods-to"></span><div id="tab1">
<table class="center" id="table-1">
            <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-mapping-restconf-methods-to" class="selfRef">Mapping RESTCONF Methods to NETCONF</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Method</th>
                <th class="text-left" rowspan="1" colspan="1">Resource class</th>
                <th class="text-left" rowspan="1" colspan="1">NETCONF operation</th>
                <th class="text-left" rowspan="1" colspan="1">Access operation</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">OPTIONS</td>
                <td class="text-left" rowspan="1" colspan="1">all</td>
                <td class="text-left" rowspan="1" colspan="1">none</td>
                <td class="text-left" rowspan="1" colspan="1">none</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">HEAD</td>
                <td class="text-left" rowspan="1" colspan="1">all</td>
                <td class="text-left" rowspan="1" colspan="1">&lt;get&gt;, &lt;get-config&gt;</td>
                <td class="text-left" rowspan="1" colspan="1">read</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">GET</td>
                <td class="text-left" rowspan="1" colspan="1">all</td>
                <td class="text-left" rowspan="1" colspan="1">&lt;get&gt;, &lt;get-config&gt;</td>
                <td class="text-left" rowspan="1" colspan="1">read</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">POST</td>
                <td class="text-left" rowspan="1" colspan="1">datastore, data</td>
                <td class="text-left" rowspan="1" colspan="1">&lt;edit-config&gt;</td>
                <td class="text-left" rowspan="1" colspan="1">create</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">POST</td>
                <td class="text-left" rowspan="1" colspan="1">operation</td>
                <td class="text-left" rowspan="1" colspan="1">specified operation</td>
                <td class="text-left" rowspan="1" colspan="1">execute</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">PUT</td>
                <td class="text-left" rowspan="1" colspan="1">data</td>
                <td class="text-left" rowspan="1" colspan="1">&lt;edit-config&gt;</td>
                <td class="text-left" rowspan="1" colspan="1">create, update</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">PUT</td>
                <td class="text-left" rowspan="1" colspan="1">datastore</td>
                <td class="text-left" rowspan="1" colspan="1">&lt;copy-config&gt;</td>
                <td class="text-left" rowspan="1" colspan="1">update</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">PATCH</td>
                <td class="text-left" rowspan="1" colspan="1">data, datastore</td>
                <td class="text-left" rowspan="1" colspan="1">&lt;edit-config&gt;</td>
                <td class="text-left" rowspan="1" colspan="1">update</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">DELETE</td>
                <td class="text-left" rowspan="1" colspan="1">data</td>
                <td class="text-left" rowspan="1" colspan="1">&lt;edit-config&gt;</td>
                <td class="text-left" rowspan="1" colspan="1">delete</td>
              </tr>
            </tbody>
          </table>
</div>
</section>
</div>
<div id="get-and-get-config-operations">
<section id="section-3.2.4">
          <h4 id="name-get-and-get-config-operatio">
<a href="#section-3.2.4" class="section-number selfRef">3.2.4. </a><a href="#name-get-and-get-config-operatio" class="section-name selfRef">&lt;get&gt; and &lt;get-config&gt; Operations</a>
          </h4>
<p id="section-3.2.4-1">The NACM access rights are not directly coupled to the &lt;get&gt; and &lt;get-config&gt; protocol operations
but apply to all &lt;rpc&gt; operations that would result in a "read" access operation to the target
datastore.  This section describes how these access rights apply to the specific access operations
supported by the &lt;get&gt; and &lt;get-config&gt; protocol operations.<a href="#section-3.2.4-1" class="pilcrow">¶</a></p>
<p id="section-3.2.4-2">Data nodes to which the client does not have read access are silently omitted, along with any
descendants, from the &lt;rpc-reply&gt; message. This is done to allow NETCONF filters for &lt;get&gt; and
&lt;get-config&gt; to function properly, instead of causing an "access-denied" error because the filter
criteria would otherwise include unauthorized read access to some data nodes.  For NETCONF filtering
purposes, the selection criteria are applied to the subset of nodes that the user is authorized to
read, not the entire datastore.<a href="#section-3.2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="edit-config-operation">
<section id="section-3.2.5">
          <h4 id="name-edit-config-operation">
<a href="#section-3.2.5" class="section-number selfRef">3.2.5. </a><a href="#name-edit-config-operation" class="section-name selfRef">&lt;edit-config&gt; Operation</a>
          </h4>
<p id="section-3.2.5-1">The NACM access rights are not directly coupled to the &lt;edit-config&gt; "operation" attribute,
although they are similar.  Instead, a NACM access right applies to all protocol operations that
would result in a particular access operation to the target datastore.  This section describes how
these access rights apply to the specific access operations supported by the &lt;edit-config&gt; protocol
operation.<a href="#section-3.2.5-1" class="pilcrow">¶</a></p>
<p id="section-3.2.5-2">If the effective access operation is "none" (i.e., default-operation="none") for a particular data
node, then no access control is applied to that data node.  This is required to allow access to
a subtree within a larger data structure.  For example, a user may be authorized to create a new
"/interfaces/interface" list entry but not be authorized to create or delete its parent container
("/interfaces").  If the "/interfaces" container already exists in the target datastore, then the
effective operation will be "none" for the "/interfaces" node if an "/interfaces/interface" list
entry is edited.<a href="#section-3.2.5-2" class="pilcrow">¶</a></p>
<p id="section-3.2.5-3">If the protocol operation would result in the creation of a datastore node and the user does not
have "create" access permission for that node, the protocol operation is rejected with an
"access-denied" error.<a href="#section-3.2.5-3" class="pilcrow">¶</a></p>
<p id="section-3.2.5-4">If the protocol operation would result in the deletion of a datastore node and the user does not
have "delete" access permission for that node, the protocol operation is rejected with an
"access-denied" error.<a href="#section-3.2.5-4" class="pilcrow">¶</a></p>
<p id="section-3.2.5-5">If the protocol operation would result in the modification of a datastore node and the user does not
have "update" access permission for that node, the protocol operation is rejected with an
"access-denied" error.<a href="#section-3.2.5-5" class="pilcrow">¶</a></p>
<p id="section-3.2.5-6">A "merge" or "replace" &lt;edit-config&gt; operation may include data nodes that do not alter portions of
the existing datastore.  For example, a container or list node may be present for naming purposes
but does not actually alter the corresponding datastore node.  These unaltered data nodes are
ignored by the server and do not require any access rights by the client.<a href="#section-3.2.5-6" class="pilcrow">¶</a></p>
<p id="section-3.2.5-7">A "merge" &lt;edit-config&gt; operation may include data nodes but not include particular child data
nodes that are present in the datastore.  These missing data nodes within the scope of a "merge"
&lt;edit-config&gt; operation are ignored by the server and do not require any access rights by the
client.<a href="#section-3.2.5-7" class="pilcrow">¶</a></p>
<p id="section-3.2.5-8">The contents of specific restricted datastore nodes <span class="bcp14">MUST NOT</span> be exposed in any &lt;rpc-error&gt; elements
within the reply.<a href="#section-3.2.5-8" class="pilcrow">¶</a></p>
<p id="section-3.2.5-9">An &lt;edit-config&gt; operation may cause data nodes to be implicitly created or deleted as an implicit
side effect of a requested operation.  For example, a YANG when-stmt expression may evaluate to
a different result, causing data nodes to be deleted, or created with default values; or if a data
node is created under one branch of a YANG choice-stmt, then all data nodes under the other branches
are<a href="#section-3.2.5-9" class="pilcrow">¶</a></p>
<p id="section-3.2.5-10">implicitly removed.  No NACM access rights are required on any data nodes that are implicitly
changed as a side effect of another allowed operation.<a href="#section-3.2.5-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copy-config-operation">
<section id="section-3.2.6">
          <h4 id="name-copy-config-operation">
<a href="#section-3.2.6" class="section-number selfRef">3.2.6. </a><a href="#name-copy-config-operation" class="section-name selfRef">&lt;copy-config&gt; Operation</a>
          </h4>
<p id="section-3.2.6-1">Access control for the &lt;copy-config&gt; protocol operation requires special consideration because the
administrator may be replacing the entire target datastore.<a href="#section-3.2.6-1" class="pilcrow">¶</a></p>
<p id="section-3.2.6-2">If the source of the &lt;copy-config&gt; protocol operation is the running configuration datastore and
the target is the startup configuration datastore, the client is only required to have permission to
execute the &lt;copy-config&gt; protocol operation.<a href="#section-3.2.6-2" class="pilcrow">¶</a></p>
<p id="section-3.2.6-3">Otherwise:<a href="#section-3.2.6-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.2.6-4.1">
              <p id="section-3.2.6-4.1.1">If the source of the &lt;copy-config&gt; operation is a datastore, then data nodes to which the client
does not have read access are silently omitted.<a href="#section-3.2.6-4.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.2.6-4.2">
              <p id="section-3.2.6-4.2.1">If the target of the &lt;copy-config&gt; operation is a datastore, the client needs access to the
modified nodes.  Specifically:<a href="#section-3.2.6-4.2.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.2.6-4.2.2.1">
                  <p id="section-3.2.6-4.2.2.1.1">If the protocol operation would result in the creation of a datastore node and the user does
not have "create" access permission for that node, the protocol operation is rejected with an
"access-denied" error.<a href="#section-3.2.6-4.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.2.6-4.2.2.2">
                  <p id="section-3.2.6-4.2.2.2.1">If the protocol operation would result in the deletion of a datastore node and the user does
not have "delete" access permission for that node, the protocol operation is rejected with an
"access-denied" error.<a href="#section-3.2.6-4.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.2.6-4.2.2.3">
                  <p id="section-3.2.6-4.2.2.3.1">If the protocol operation would result in the modification of a datastore node and the user
does not have "update" access permission for that node, the protocol operation is rejected with
an "access-denied" error.<a href="#section-3.2.6-4.2.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
</section>
</div>
<div id="delete-config-operation">
<section id="section-3.2.7">
          <h4 id="name-delete-config-operation">
<a href="#section-3.2.7" class="section-number selfRef">3.2.7. </a><a href="#name-delete-config-operation" class="section-name selfRef">&lt;delete-config&gt; Operation</a>
          </h4>
<p id="section-3.2.7-1">Access to the &lt;delete-config&gt; protocol operation is denied by default.  The "exec-default" leaf
does not apply to this protocol operation.  Access control rules must be explicitly configured to
allow invocation by a non-recovery session.<a href="#section-3.2.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="commit-operation">
<section id="section-3.2.8">
          <h4 id="name-commit-operation">
<a href="#section-3.2.8" class="section-number selfRef">3.2.8. </a><a href="#name-commit-operation" class="section-name selfRef">&lt;commit&gt; Operation</a>
          </h4>
<p id="section-3.2.8-1">The server MUST determine the exact nodes in the running configuration datastore that are actually
different and only check "create", "update", and "delete" access permissions for this set of nodes,
which could be empty.<a href="#section-3.2.8-1" class="pilcrow">¶</a></p>
<p id="section-3.2.8-2">For example, if a session can read the entire datastore but only change one leaf, that session needs
to be able to edit and commit that one leaf.<a href="#section-3.2.8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="discard-changes-operation">
<section id="section-3.2.9">
          <h4 id="name-discard-changes-operation">
<a href="#section-3.2.9" class="section-number selfRef">3.2.9. </a><a href="#name-discard-changes-operation" class="section-name selfRef">&lt;discard-changes&gt; Operation</a>
          </h4>
<p id="section-3.2.9-1">The client is only required to have permission to execute the &lt;discard-changes&gt; protocol operation.
No datastore permissions are needed.<a href="#section-3.2.9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="kill-session-operation">
<section id="section-3.2.10">
          <h4 id="name-kill-session-operation">
<a href="#section-3.2.10" class="section-number selfRef">3.2.10. </a><a href="#name-kill-session-operation" class="section-name selfRef">&lt;kill-session&gt; Operation</a>
          </h4>
<p id="section-3.2.10-1">The &lt;kill-session&gt; operation does not directly alter a datastore. However, it allows one session to
disrupt another session that is editing a datastore.<a href="#section-3.2.10-1" class="pilcrow">¶</a></p>
<p id="section-3.2.10-2">Access to the &lt;kill-session&gt; protocol operation is denied by default. The "exec-default" leaf does
not apply to this protocol operation. Access control rules must be explicitly configured to allow
invocation by a non-recovery session.<a href="#section-3.2.10-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="model-components">
<section id="section-3.3">
        <h3 id="name-model-components">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-model-components" class="section-name selfRef">Model Components</a>
        </h3>
<p id="section-3.3-1">This section defines the conceptual components related to the access control model.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<div id="users">
<section id="section-3.3.1">
          <h4 id="name-users">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-users" class="section-name selfRef">Users</a>
          </h4>
<p id="section-3.3.1-1">A "user" is the conceptual entity that is associated with the access permissions granted to
a particular session.  A user is identified by a string that is unique within the server.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2">As described in [RFC6241], the username string is derived from the transport layer during session
establishment.  If the transport layer cannot authenticate the user, the session is terminated.<a href="#section-3.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="groups">
<section id="section-3.3.2">
          <h4 id="name-groups">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-groups" class="section-name selfRef">Groups</a>
          </h4>
<p id="section-3.3.2-1">Access to a specific NETCONF protocol operation is granted to a session.  The session is associated
with a group (i.e., not with a user).<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.2-2">A group is identified by its name.  All group names are unique within the server.<a href="#section-3.3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.3.2-3">Access control is applied at the level of groups.  A group contains zero or more group members.<a href="#section-3.3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.3.2-4">A group member is identified by a username string.<a href="#section-3.3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.3.2-5">The same user can be a member of multiple groups.<a href="#section-3.3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="emergency-recovery-session">
<section id="section-3.3.3">
          <h4 id="name-emergency-recovery-session">
<a href="#section-3.3.3" class="section-number selfRef">3.3.3. </a><a href="#name-emergency-recovery-session" class="section-name selfRef">Emergency Recovery Session</a>
          </h4>
<p id="section-3.3.3-1">The server MAY support a recovery session mechanism, which will bypass all access control
enforcement.  This is useful for restricting initial access and repairing a broken access control
configuration.<a href="#section-3.3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="global-enforcement-controls">
<section id="section-3.3.4">
          <h4 id="name-global-enforcement-controls">
<a href="#section-3.3.4" class="section-number selfRef">3.3.4. </a><a href="#name-global-enforcement-controls" class="section-name selfRef">Global Enforcement Controls</a>
          </h4>
<p id="section-3.3.4-1">There are five global controls that are used to help control how access control is enforced.<a href="#section-3.3.4-1" class="pilcrow">¶</a></p>
<div id="enable-nacm-switch">
<section id="section-3.3.4.1">
            <h5 id="name-enable-nacm-switch">
<a href="#section-3.3.4.1" class="section-number selfRef">3.3.4.1. </a><a href="#name-enable-nacm-switch" class="section-name selfRef">enable-nacm Switch</a>
            </h5>
<p id="section-3.3.4.1-1">A global "enable-nacm" on/off switch is provided to enable or disable all access control
enforcement.  When this global switch is set to "true", all requests are checked against the access
control rules and only permitted if configured to allow the specific access request. When this
global switch is set to "false", all access requests are permitted.<a href="#section-3.3.4.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="read-default-switch">
<section id="section-3.3.4.2">
            <h5 id="name-read-default-switch">
<a href="#section-3.3.4.2" class="section-number selfRef">3.3.4.2. </a><a href="#name-read-default-switch" class="section-name selfRef">read-default Switch</a>
            </h5>
<p id="section-3.3.4.2-1">An on/off "read-default" switch is provided to enable or disable default access to receive data in
replies and notifications.  When the "enable-nacm" global switch is set to "true", this global
switch is relevant if no matching access control rule is found to explicitly permit or deny read
access to the requested datastore data or notification event type.<a href="#section-3.3.4.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.4.2-2">When this global switch is set to "permit" and no matching access control rule is found for the
datastore read or notification event requested, access is permitted.<a href="#section-3.3.4.2-2" class="pilcrow">¶</a></p>
<p id="section-3.3.4.2-3">When this global switch is set to "deny" and no matching access control rule is found for the
datastore read or notification event requested, access is denied.  This means that the requested
data is not sent to the client.  See step 11 in <a href="#data-node-access-validation" class="xref">Section 3.4.5</a> for details.<a href="#section-3.3.4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="write-default-switch">
<section id="section-3.3.4.3">
            <h5 id="name-write-default-switch">
<a href="#section-3.3.4.3" class="section-number selfRef">3.3.4.3. </a><a href="#name-write-default-switch" class="section-name selfRef">write-default Switch</a>
            </h5>
<p id="section-3.3.4.3-1">An on/off "write-default" switch is provided to enable or disable default access to alter
configuration data.  When the "enable-nacm" global switch is set to "true", this global switch is
relevant if no matching access control rule is found to explicitly permit or deny write access to
the requested datastore data.<a href="#section-3.3.4.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3.4.3-2">When this global switch is set to "permit" and no matching access control rule is found for the
datastore write requested, access is permitted.<a href="#section-3.3.4.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3.4.3-3">When this global switch is set to "deny" and no matching access control rule is found for the
datastore write requested, access is denied. See step 12 in
<a href="#data-node-access-validation" class="xref">Section 3.4.5</a> for details.<a href="#section-3.3.4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="exec-default-switch">
<section id="section-3.3.4.4">
            <h5 id="name-exec-default-switch">
<a href="#section-3.3.4.4" class="section-number selfRef">3.3.4.4. </a><a href="#name-exec-default-switch" class="section-name selfRef">exec-default Switch</a>
            </h5>
<p id="section-3.3.4.4-1">An on/off "exec-default" switch is provided to enable or disable default access to execute protocol
operations.  When the "enable-nacm" global switch is set to "true", this global switch is relevant
if no matching access control rule is found to explicitly permit or deny access to the requested
NETCONF protocol operation.<a href="#section-3.3.4.4-1" class="pilcrow">¶</a></p>
<p id="section-3.3.4.4-2">When this global switch is set to "permit" and no matching access control rule is found for the
NETCONF protocol operation requested, access is permitted.<a href="#section-3.3.4.4-2" class="pilcrow">¶</a></p>
<p id="section-3.3.4.4-3">When this global switch is set to "deny" and no matching access control rule is found for the
NETCONF protocol operation requested, access is denied.  See step 12 in <a href="#incoming-rpc-message-validation" class="xref">Section 3.4.4</a>
and step 13 in <a href="#data-node-access-validation" class="xref">Section 3.4.5</a> for details.<a href="#section-3.3.4.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="enable-external-groups-switch">
<section id="section-3.3.4.5">
            <h5 id="name-enable-external-groups-swit">
<a href="#section-3.3.4.5" class="section-number selfRef">3.3.4.5. </a><a href="#name-enable-external-groups-swit" class="section-name selfRef">enable-external-groups Switch</a>
            </h5>
<p id="section-3.3.4.5-1">When this global switch is set to "true", the group names reported by the transport layer for
a session are used together with the locally configured group names to determine the access control
rules for the session.<a href="#section-3.3.4.5-1" class="pilcrow">¶</a></p>
<p id="section-3.3.4.5-2">When this switch is set to "false", the group names reported by the transport layer are ignored by
the NACM.<a href="#section-3.3.4.5-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="access-control-rules">
<section id="section-3.3.5">
          <h4 id="name-access-control-rules">
<a href="#section-3.3.5" class="section-number selfRef">3.3.5. </a><a href="#name-access-control-rules" class="section-name selfRef">Access Control Rules</a>
          </h4>
<p id="section-3.3.5-1">There are four types of rules available in the NACM:<a href="#section-3.3.5-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-3.3.5-2">
            <dt id="section-3.3.5-2.1">module rule:</dt>
<dd id="section-3.3.5-2.2">
              <p id="section-3.3.5-2.2.1">controls access for definitions in a specific YANG module, identified by its name.<a href="#section-3.3.5-2.2.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-3.3.5-2.3">protocol operation rule:</dt>
<dd id="section-3.3.5-2.4">
              <p id="section-3.3.5-2.4.1">controls access for a specific protocol operation, identified by its YANG module and name.<a href="#section-3.3.5-2.4.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-3.3.5-2.5">data node rule:</dt>
<dd id="section-3.3.5-2.6">
              <p id="section-3.3.5-2.6.1">controls access for a specific data node and its descendants, identified by its path location
within the conceptual XML document for the data node.<a href="#section-3.3.5-2.6.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-3.3.5-2.7">notification rule:</dt>
<dd id="section-3.3.5-2.8">
              <p id="section-3.3.5-2.8.1">controls access for a specific notification event type, identified by its YANG module and name.<a href="#section-3.3.5-2.8.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="access-control-enforcement-procedures">
<section id="section-3.4">
        <h3 id="name-access-control-enforcement-">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-access-control-enforcement-" class="section-name selfRef">Access Control Enforcement Procedures</a>
        </h3>
<p id="section-3.4-1">There are six separate phases that need to be addressed, four of which are related to the NETCONF
message processing model (#(message-processing-model)):<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.4-2">
          <li id="section-3.4-2.1">
            <p id="section-3.4-2.1.1">Initial operation<a href="#section-3.4-2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4-2.2">
            <p id="section-3.4-2.2.1">Session establishment<a href="#section-3.4-2.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4-2.3">
            <p id="section-3.4-2.3.1">"access-denied" error handling<a href="#section-3.4-2.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4-2.4">
            <p id="section-3.4-2.4.1">Incoming RPC message validation<a href="#section-3.4-2.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4-2.5">
            <p id="section-3.4-2.5.1">Data node access validation<a href="#section-3.4-2.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4-2.6">
            <p id="section-3.4-2.6.1">Outgoing &lt;notification&gt; authorization<a href="#section-3.4-2.6.1" class="pilcrow">¶</a></p>
</li>
</ol>
<p id="section-3.4-3">In addition, the initial startup mode for a NETCONF server, session establishment, and
"access-denied" error-handling procedures also need to be considered.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">The server <span class="bcp14">MUST</span> use the access control rules in effect at the time it starts processing the message.
The same access control rules <span class="bcp14">MUST</span> stay in effect for the processing of the entire message.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<div id="initial-operation">
<section id="section-3.4.1">
          <h4 id="name-initial-operation">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-initial-operation" class="section-name selfRef">Initial Operation</a>
          </h4>
<p id="section-3.4.1-1">Upon the very first startup of the NETCONF server, the access control configuration will probably
not be present.  If it isn't, a server <span class="bcp14">MUST NOT</span> allow any write access to any session role except
a recovery session.<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
<p id="section-3.4.1-2">Access rules are enforced any time a request is initiated from a user session.  Access control is
not enforced for server-initiated access requests, such as the initial load of the running
configuration datastore, during bootup.<a href="#section-3.4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="session-establishment">
<section id="section-3.4.2">
          <h4 id="name-session-establishment">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-session-establishment" class="section-name selfRef">Session Establishment</a>
          </h4>
<p id="section-3.4.2-1">The access control model applies specifically to the well-formed XML content transferred between
a client and a server after session establishment has been completed and after the &lt;hello&gt; exchange
has been successfully completed.<a href="#section-3.4.2-1" class="pilcrow">¶</a></p>
<p id="section-3.4.2-2">Once session establishment is completed and a user has been authenticated, the transport layer
reports the username and a possibly empty set of group names associated with the user to the NETCONF
server.  The NETCONF server will enforce the access control rules, based on the supplied username,
group names, and the configuration data stored on the server.<a href="#section-3.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="access-denied-error-handling">
<section id="section-3.4.3">
          <h4 id="name-access-denied-error-handlin">
<a href="#section-3.4.3" class="section-number selfRef">3.4.3. </a><a href="#name-access-denied-error-handlin" class="section-name selfRef">"access-denied" Error Handling</a>
          </h4>
<p id="section-3.4.3-1">The "access-denied" error-tag is generated when the access control system denies access to either
a request to invoke a protocol operation or a request to perform a particular access operation on
the configuration datastore.<a href="#section-3.4.3-1" class="pilcrow">¶</a></p>
<p id="section-3.4.3-2">A server <span class="bcp14">MUST NOT</span> include any information the client is not allowed to read in any &lt;error-info&gt;
elements within the &lt;rpc-error&gt; response.<a href="#section-3.4.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="incoming-rpc-message-validation">
<section id="section-3.4.4">
          <h4 id="name-incoming-rpc-message-valida">
<a href="#section-3.4.4" class="section-number selfRef">3.4.4. </a><a href="#name-incoming-rpc-message-valida" class="section-name selfRef">Incoming RPC Message Validation</a>
          </h4>
<p id="section-3.4.4-1">The diagram below shows the basic conceptual structure of the access control processing model for
incoming NETCONF &lt;rpc&gt; messages within a server.<a href="#section-3.4.4-1" class="pilcrow">¶</a></p>
<span id="name-access-control-begins-with-"></span><div id="fig3">
<figure id="figure-1">
            <div class="artwork art-text alignLeft" id="section-3.4.4-2.1">
<pre>          NETCONF server
          +------------+
          |    XML     |
          |   message  |
          | dispatcher |
          +------------+
                 |
                 |
                 V
         +---------------+
         | &lt;rpc&gt; message |
         +---------------+
           |    |     |
           |    |     +--------------------------------+
           |    +---------------+                      |
           V                    V                      V
 +------------------+ +--------------------+ +--------------------+
 | vendor operation | | standard operation | | standard operation |
 |    &lt;my-edit&gt;     | |   &lt;edit-config&gt;    | |      &lt;unlock&gt;      |
 +------------------+ +--------------------+ +--------------------+
             |                 |
             |                 |
             V                 V
            +----------------------+
            |    configuration     |
            |      datastore       |
            +----------------------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-access-control-begins-with-" class="selfRef">Access control begins with the message dispatcher.</a>
            </figcaption></figure>
</div>
<p id="section-3.4.4-3">After the server validates the &lt;rpc&gt; element and determines the namespace URI and the element name
of the protocol operation being requested, the server verifies that the user is authorized to invoke
the protocol operation.<a href="#section-3.4.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4.4-4">The server MUST separately authorize every protocol operation by following these steps:<a href="#section-3.4.4-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.4.4-5">
            <li id="section-3.4.4-5.1">
              <p id="section-3.4.4-5.1.1">If the "enable-nacm" leaf is set to "false", then the protocol operation is permitted.<a href="#section-3.4.4-5.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.4-5.2">
              <p id="section-3.4.4-5.2.1">If the requesting session is identified as a recovery session, then the protocol operation is
permitted.<a href="#section-3.4.4-5.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.4-5.3">
              <p id="section-3.4.4-5.3.1">If the requested operation is the NETCONF &lt;close-session&gt; protocol operation, then the protocol
operation is permitted.<a href="#section-3.4.4-5.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.4-5.4">
              <p id="section-3.4.4-5.4.1">Check all the "group" entries to see if any of them contain a "user-name" entry that equals the
username for the session making the request.  If the "enable-external-groups" leaf is "true", add
to these groups the set of groups provided by the transport layer.<a href="#section-3.4.4-5.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.4-5.5">
              <p id="section-3.4.4-5.5.1">If no groups are found, continue with step 10.<a href="#section-3.4.4-5.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.4-5.6">
              <p id="section-3.4.4-5.6.1">Process all rule-list entries, in the order they appear in the configuration.  If a rule-list's
"group" leaf-list does not match any of the user's groups, proceed to the next rule-list entry.<a href="#section-3.4.4-5.6.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.4-5.7">
              <p id="section-3.4.4-5.7.1">For each rule-list entry found, process all rules, in order, until a rule that matches the
requested access operation is found.  A rule matches if all of the following criteria are met:<a href="#section-3.4.4-5.7.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.4.4-5.7.2.1">
                  <p id="section-3.4.4-5.7.2.1.1">The rule's "module-name" leaf is "*" or equals the name of the YANG module where the protocol
operation is defined.<a href="#section-3.4.4-5.7.2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.4-5.7.2.2">
                  <p id="section-3.4.4-5.7.2.2.1">Either (1) the rule does not have a "rule-type" defined or (2) the "rule-type" is
"protocol-operation" and the "rpc-name" is "*" or equals the name of the requested protocol
operation.<a href="#section-3.4.4-5.7.2.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.4-5.7.2.3">
                  <p id="section-3.4.4-5.7.2.3.1">The rule's "access-operations" leaf has the "exec" bit set or has the special value "*".<a href="#section-3.4.4-5.7.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li id="section-3.4.4-5.8">
              <p id="section-3.4.4-5.8.1">If a matching rule is found, then the "action" leaf is checked. If it is equal to "permit",
 then the protocol operation is permitted; otherwise, it is denied.<a href="#section-3.4.4-5.8.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.4-5.9">
              <p id="section-3.4.4-5.9.1">At this point, no matching rule was found in any rule-list entry.<a href="#section-3.4.4-5.9.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.4-5.10">
              <p id="section-3.4.4-5.10.1">If the requested protocol operation is defined in a YANG module advertised in the server
 capabilities and the "rpc" statement contains a "nacm:default-deny-all" statement, then the
 protocol operation is denied.<a href="#section-3.4.4-5.10.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.4-5.11">
              <p id="section-3.4.4-5.11.1">If the requested protocol operation is the NETCONF &lt;kill-session&gt; or &lt;delete-config&gt;, then
 the protocol operation is denied.<a href="#section-3.4.4-5.11.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.4-5.12">
              <p id="section-3.4.4-5.12.1">If the "exec-default" leaf is set to "permit", then permit the protocol operation; otherwise,
 deny the request.<a href="#section-3.4.4-5.12.1" class="pilcrow">¶</a></p>
</li>
</ol>
<p id="section-3.4.4-6">If the user is not authorized to invoke the protocol operation, then an &lt;rpc-error&gt; is generated
with the following information:<a href="#section-3.4.4-6" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-3.4.4-7">
            <dt id="section-3.4.4-7.1">error-tag:</dt>
<dd id="section-3.4.4-7.2">
              <p id="section-3.4.4-7.2.1">access-denied<a href="#section-3.4.4-7.2.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-3.4.4-7.3">error-path:</dt>
<dd id="section-3.4.4-7.4">
              <p id="section-3.4.4-7.4.1">Identifies the requested protocol operation.  The following example represents the
&lt;edit-config&gt; protocol operation in the NETCONF base namespace:<a href="#section-3.4.4-7.4.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
</dl>
<div class="artwork art-text alignLeft" id="section-3.4.4-8">
<pre> &lt;error-path
    xmlns:nc="urn:ietf:params:xml:ns:netconf:base:1.0"&gt;
        /nc:rpc/nc:edit-config
 &lt;/error-path&gt;
</pre><a href="#section-3.4.4-8" class="pilcrow">¶</a>
</div>
<p id="section-3.4.4-9">If a datastore is accessed, either directly or as a side effect of the protocol operation, then the
server MUST intercept the access operation and make sure that the user is authorized to perform the
requested access operation on the specified data, as defined in <a href="#data-node-access-validation" class="xref">Section 3.4.5</a>.<a href="#section-3.4.4-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="data-node-access-validation">
<section id="section-3.4.5">
          <h4 id="name-data-node-access-validation">
<a href="#section-3.4.5" class="section-number selfRef">3.4.5. </a><a href="#name-data-node-access-validation" class="section-name selfRef">Data Node Access Validation</a>
          </h4>
<p id="section-3.4.5-1">If (1) a data node within a datastore is accessed or (2) an action or notification is tied to a data
node, then the server MUST ensure that the user is authorized to perform the requested "read",
"create", "update", "delete", or "execute" access operation on the specified data node.<a href="#section-3.4.5-1" class="pilcrow">¶</a></p>
<p id="section-3.4.5-2">If an action is requested to be executed, the server MUST ensure that the user is authorized to
perform the "execute" access operation on the requested action.<a href="#section-3.4.5-2" class="pilcrow">¶</a></p>
<p id="section-3.4.5-3">If a notification tied to a data node is generated, the server MUST ensure that the user is
authorized to perform the "read" access operation on the requested notification.<a href="#section-3.4.5-3" class="pilcrow">¶</a></p>
<p id="section-3.4.5-4">The data node access request is authorized by following these steps:<a href="#section-3.4.5-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.4.5-5">
            <li id="section-3.4.5-5.1">
              <p id="section-3.4.5-5.1.1">If the "enable-nacm" leaf is set to "false", then the access operation is permitted.<a href="#section-3.4.5-5.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.5-5.2">
              <p id="section-3.4.5-5.2.1">If the requesting session is identified as a recovery session, then the access operation is permitted.<a href="#section-3.4.5-5.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.5-5.3">
              <p id="section-3.4.5-5.3.1">Check all the "group" entries to see if any of them contain a "user-name" entry that equals the
username for the session making the request.  If the "enable-external-groups" leaf is "true",
add to these groups the set of groups provided by the transport layer.<a href="#section-3.4.5-5.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.5-5.4">
              <p id="section-3.4.5-5.4.1">If no groups are found, continue with step 9.<a href="#section-3.4.5-5.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.5-5.5">
              <p id="section-3.4.5-5.5.1">Process all rule-list entries, in the order they appear in the configuration.  If a rule-list's
"group" leaf-list does not match any of the user's groups, proceed to the next rule-list entry.<a href="#section-3.4.5-5.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.5-5.6">
              <p id="section-3.4.5-5.6.1">For each rule-list entry found, process all rules, in order, until a rule that matches the
requested access operation is found.  A rule matches if all of the following criteria are met:<a href="#section-3.4.5-5.6.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.4.5-5.6.2.1">
                  <p id="section-3.4.5-5.6.2.1.1">The rule's "module-name" leaf is "*" or equals the name of the YANG module where the requested
data node is defined.<a href="#section-3.4.5-5.6.2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.5-5.6.2.2">
                  <p id="section-3.4.5-5.6.2.2.1">Either (1) the rule does not have a "rule-type" defined or (2) the "rule-type" is "data-node"
and the "path" matches the requested data node, action node, or notification node.  A path is
considered to match if the requested node is the node specified by the path or is a descendant
node of the path.<a href="#section-3.4.5-5.6.2.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.5-5.6.2.3">
                  <p id="section-3.4.5-5.6.2.3.1">For a "read" access operation, the rule's "access-operations" leaf has the "read" bit set or
has the special value "*".<a href="#section-3.4.5-5.6.2.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.5-5.6.2.4">
                  <p id="section-3.4.5-5.6.2.4.1">For a "create" access operation, the rule's "access-operations" leaf has the "create" bit set
or has the special value "*".<a href="#section-3.4.5-5.6.2.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.5-5.6.2.5">
                  <p id="section-3.4.5-5.6.2.5.1">For a "delete" access operation, the rule's "access-operations" leaf has the "delete" bit set
or has the special value "*".<a href="#section-3.4.5-5.6.2.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.5-5.6.2.6">
                  <p id="section-3.4.5-5.6.2.6.1">For an "update" access operation, the rule's "access-operations" leaf has the "update" bit set
or has the special value "*".<a href="#section-3.4.5-5.6.2.6.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.5-5.6.2.7">
                  <p id="section-3.4.5-5.6.2.7.1">For an "execute" access operation, the rule's "access-operations" leaf has the "exec" bit set
or has the special value "*".<a href="#section-3.4.5-5.6.2.7.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li id="section-3.4.5-5.7">
              <p id="section-3.4.5-5.7.1">If a matching rule is found, then the "action" leaf is checked. If it is equal to "permit", then
the data node access is permitted; otherwise, it is denied.  For a "read" access operation,
"denied" means that the requested data is not returned in the reply.<a href="#section-3.4.5-5.7.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.5-5.8">
              <p id="section-3.4.5-5.8.1">At this point, no matching rule was found in any rule-list entry.<a href="#section-3.4.5-5.8.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.5-5.9">
              <p id="section-3.4.5-5.9.1">For a "read" access operation, if the requested data node is defined in a YANG module advertised
in the server capabilities and the data definition statement contains a "nacm:default-deny-all"
statement, then the requested data node and all its descendants are not included in the reply.<a href="#section-3.4.5-5.9.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.5-5.10">
              <p id="section-3.4.5-5.10.1">For a "write" access operation, if the requested data node is defined in a YANG module
advertised in the server capabilities and the data definition statement contains
a "nacm:default-deny-write" or a "nacm:default-deny-all" statement, then the access request is
denied for the data node and all its descendants.<a href="#section-3.4.5-5.10.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.5-5.11">
              <p id="section-3.4.5-5.11.1">For a "read" access operation, if the "read-default" leaf is set to "permit", then include the
requested data node in the reply; otherwise, do not include the requested data node or any of
its descendants in the reply.<a href="#section-3.4.5-5.11.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.5-5.12">
              <p id="section-3.4.5-5.12.1">For a "write" access operation, if the "write-default" leaf is set to "permit", then permit the
data node access request; otherwise, deny the request.<a href="#section-3.4.5-5.12.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.5-5.13">
              <p id="section-3.4.5-5.13.1">For an "execute" access operation, if the "exec-default" leaf is set to "permit", then permit
the request; otherwise, deny the request.<a href="#section-3.4.5-5.13.1" class="pilcrow">¶</a></p>
</li>
</ol>
</section>
</div>
<div id="outgoing-notification-authorization">
<section id="section-3.4.6">
          <h4 id="name-outgoing-notification-autho">
<a href="#section-3.4.6" class="section-number selfRef">3.4.6. </a><a href="#name-outgoing-notification-autho" class="section-name selfRef">Outgoing &lt;notification&gt; Authorization</a>
          </h4>
<p id="section-3.4.6-1">Configuration of access control rules specifically for descendant nodes of the notification event
type are outside the scope of this document.  If the user is authorized to receive the notification
event type, then it is also authorized to receive any data it contains.<a href="#section-3.4.6-1" class="pilcrow">¶</a></p>
<p id="section-3.4.6-2">If the notification is specified within a data subtree, as specified in <span>[<a href="#RFC7950" class="xref">RFC7950</a>]</span>, then read
access to the notification is required. Processing continues as described in
<a href="#data-node-access-validation" class="xref">Section 3.4.5</a>.<a href="#section-3.4.6-2" class="pilcrow">¶</a></p>
<p id="section-3.4.6-3">The following figure shows the conceptual message processing model for outgoing &lt;notification&gt;
messages.<a href="#section-3.4.6-3" class="pilcrow">¶</a></p>
<div id="fig4">
<div class="artwork art-text alignCenter" id="section-3.4.6-4">
<pre>       NETCONF server
      +------------+
      |    XML     |
      |   message  |
      | generator  |
      +------------+
            ^
            |
    +----------------+
    | &lt;notification&gt; |
    |  generator     |
    +----------------+
            ^
            |
   +=================+
   | &lt;notification&gt;  |
   |  access control |
   |  &lt;eventType&gt;    |
   +=================+
            ^
            |
+------------------------+
| server instrumentation |
+------------------------+
          |     ^
          V     |
 +----------------------+
 |    configuration     |
 |      datastore       |
 +----------------------+
</pre><a href="#section-3.4.6-4" class="pilcrow">¶</a>
</div>
</div>
<p id="section-3.4.6-5">The generation of a notification for a specific subscription <span>[<a href="#RFC5277" class="xref">RFC5277</a>]</span> is authorized by following
these steps:<a href="#section-3.4.6-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.4.6-6">
            <li id="section-3.4.6-6.1">
              <p id="section-3.4.6-6.1.1">If the "enable-nacm" leaf is set to "false", then the notification is permitted.<a href="#section-3.4.6-6.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.6-6.2">
              <p id="section-3.4.6-6.2.1">If the session is identified as a recovery session, then the notification is permitted.<a href="#section-3.4.6-6.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.6-6.3">
              <p id="section-3.4.6-6.3.1">If the notification is the NETCONF &lt;replayComplete&gt; or &lt;notificationComplete&gt; event type
<span>[<a href="#RFC5277" class="xref">RFC5277</a>]</span>, then the notification is permitted.<a href="#section-3.4.6-6.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.6-6.4">
              <p id="section-3.4.6-6.4.1">Check all the "group" entries to see if any of them contain a "user-name" entry that equals the
username for the session making the request.  If the "enable-external-groups" leaf is "true", add
to these groups the set of groups provided by the transport layer.<a href="#section-3.4.6-6.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.6-6.5">
              <p id="section-3.4.6-6.5.1">If no groups are found, continue with step 10.<a href="#section-3.4.6-6.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.6-6.6">
              <p id="section-3.4.6-6.6.1">Process all rule-list entries, in the order they appear in the configuration.  If a rule-list's
"group" leaf-list does not match any of the user's groups, proceed to the next rule-list entry.<a href="#section-3.4.6-6.6.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.6-6.7">
              <p id="section-3.4.6-6.7.1">For each rule-list entry found, process all rules, in order, until a rule that matches the
requested access operation is found.  A rule matches if all of the following criteria are met:<a href="#section-3.4.6-6.7.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.4.6-6.7.2.1">
                  <p id="section-3.4.6-6.7.2.1.1">The rule's "module-name" leaf is "*" or equals the name of the YANG module where the
notification is defined.<a href="#section-3.4.6-6.7.2.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.6-6.7.2.2">
                  <p id="section-3.4.6-6.7.2.2.1">Either (1) the rule does not have a "rule-type" defined or (2) the "rule-type" is
"notification" and the "notification-name" is "*" or equals the name of the notification.<a href="#section-3.4.6-6.7.2.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.6-6.7.2.3">
                  <p id="section-3.4.6-6.7.2.3.1">The rule's "access-operations" leaf has the "read" bit set or has the special value "*".<a href="#section-3.4.6-6.7.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li id="section-3.4.6-6.8">
              <p id="section-3.4.6-6.8.1">If a matching rule is found, then the "action" leaf is checked. If it is equal to "permit",
then permit the notification; otherwise, drop the notification for the associated
subscription.<a href="#section-3.4.6-6.8.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.6-6.9">
              <p id="section-3.4.6-6.9.1">Otherwise, no matching rule was found in any rule-list entry.<a href="#section-3.4.6-6.9.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.6-6.10">
              <p id="section-3.4.6-6.10.1">If the requested notification is defined in a YANG module advertised in the server capabilities
and the "notification" statement contains a "nacm:default-deny-all" statement, then the
notification is dropped for the associated subscription.<a href="#section-3.4.6-6.10.1" class="pilcrow">¶</a></p>
</li>
<li id="section-3.4.6-6.11">
              <p id="section-3.4.6-6.11.1">If the "read-default" leaf is set to "permit", then permit the notification; otherwise, drop the
notification for the associated subscription.<a href="#section-3.4.6-6.11.1" class="pilcrow">¶</a></p>
</li>
</ol>
</section>
</div>
</section>
</div>
<div id="data-model-definitions">
<section id="section-3.5">
        <h3 id="name-data-model-definitions">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-data-model-definitions" class="section-name selfRef">Data Model Definitions</a>
        </h3>
<div id="data-organization">
<section id="section-3.5.1">
          <h4 id="name-data-organization">
<a href="#section-3.5.1" class="section-number selfRef">3.5.1. </a><a href="#name-data-organization" class="section-name selfRef">Data Organization</a>
          </h4>
<p id="section-3.5.1-1">The following diagram highlights the contents and structure of the NACM YANG module.<a href="#section-3.5.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.5.1-2">
<pre>module: ietf-netconf-acm
  +--rw nacm
     +--rw enable-nacm?              boolean
     +--rw read-default?             action-type
     +--rw write-default?            action-type
     +--rw exec-default?             action-type
     +--rw enable-external-groups?   boolean
     +--ro denied-operations         yang:zero-based-counter32
     +--ro denied-data-writes        yang:zero-based-counter32
     +--ro denied-notifications      yang:zero-based-counter32
     +--rw groups
     |  +--rw group* [name]
     |     +--rw name         group-name-type
     |     +--rw user-name*   user-name-type
     +--rw rule-list* [name]
        +--rw name     string
        +--rw group*   union
        +--rw rule* [name]
           +--rw name                 string
           +--rw module-name?         union
           +--rw (rule-type)?
           |  +--:(protocol-operation)
           |  |  +--rw rpc-name?            union
           |  +--:(notification)
           |  |  +--rw notification-name?   union
           |  +--:(data-node)
           |     +--rw path                 node-instance-identifier
           +--rw access-operations?   union
           +--rw action               action-type
           +--rw comment?             string
</pre><a href="#section-3.5.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="yang-module">
<section id="section-3.5.2">
          <h4 id="name-yang-module">
<a href="#section-3.5.2" class="section-number selfRef">3.5.2. </a><a href="#name-yang-module" class="section-name selfRef">YANG Module</a>
          </h4>
<p id="section-3.5.2-1">The following YANG module specifies the normative NETCONF content that <span class="bcp14">MUST</span> be supported by the
server.<a href="#section-3.5.2-1" class="pilcrow">¶</a></p>
<p id="section-3.5.2-2">The "ietf-netconf-acm" YANG module imports typedefs from <span>[<a href="#RFC6991" class="xref">RFC6991</a>]</span>.<a href="#section-3.5.2-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.5.2-3">
<pre>&lt;CODE BEGINS&gt; file "ietf-netconf-acm@2018-02-14.yang"
module ietf-netconf-acm {

 namespace "urn:ietf:params:xml:ns:yang:ietf-netconf-acm";

 prefix nacm;

 import ietf-yang-types {
   prefix yang;
 }

 organization
   "IETF NETCONF (Network Configuration) Working Group";

 contact
   "WG Web:   &lt;https://datatracker.ietf.org/wg/netconf/&gt;
    WG List:  &lt;mailto:netconf@ietf.org&gt;

    Author:   Andy Bierman
              &lt;mailto:andy@yumaworks.com&gt;

    Author:   Martin Bjorklund
              &lt;mailto:mbj@tail-f.com&gt;";

 description
   "Network Configuration Access Control Model.

    Copyright (c) 2012 - 2018 IETF Trust and the persons
    identified as authors of the code.  All rights reserved.

    Redistribution and use in source and binary forms, with or
    without modification, is permitted pursuant to, and subject
    to the license terms contained in, the Simplified BSD
    License set forth in Section 4.c of the IETF Trust's
    Legal Provisions Relating to IETF Documents
    (https://trustee.ietf.org/license-info).

    This version of this YANG module is part of RFC 8341; see
    the RFC itself for full legal notices.";

 revision "2018-02-14" {
   description
     "Added support for YANG 1.1 actions and notifications tied to
      data nodes.  Clarified how NACM extensions can be used by
      other data models.";
   reference
     "RFC 8341: Network Configuration Access Control Model";
 }

 revision "2012-02-22" {
   description
     "Initial version.";
   reference
     "RFC 6536: Network Configuration Protocol (NETCONF)
                Access Control Model";
 }

 /*
  * Extension statements
  */

 extension default-deny-write {
   description
     "Used to indicate that the data model node
      represents a sensitive security system parameter.

      If present, the NETCONF server will only allow the designated
      'recovery session' to have write access to the node.  An
      explicit access control rule is required for all other users.

      If the NACM module is used, then it must be enabled (i.e.,
      /nacm/enable-nacm object equals 'true'), or this extension
      is ignored.

      The 'default-deny-write' extension MAY appear within a data
      definition statement.  It is ignored otherwise.";
 }

 extension default-deny-all {
   description
     "Used to indicate that the data model node
      controls a very sensitive security system parameter.

      If present, the NETCONF server will only allow the designated
      'recovery session' to have read, write, or execute access to
      the node.  An explicit access control rule is required for all
      other users.

      If the NACM module is used, then it must be enabled (i.e.,
      /nacm/enable-nacm object equals 'true'), or this extension
      is ignored.

      The 'default-deny-all' extension MAY appear within a data
      definition statement, 'rpc' statement, or 'notification'
      statement.  It is ignored otherwise.";
 }

 /*
  * Derived types
  */

 typedef user-name-type {
   type string {
     length "1..max";
   }
   description
     "General-purpose username string.";
 }

 typedef matchall-string-type {
   type string {
     pattern '\*';
   }
   description
     "The string containing a single asterisk '*' is used
      to conceptually represent all possible values
      for the particular leaf using this data type.";
 }

 typedef access-operations-type {
   type bits {
     bit create {
       description
         "Any protocol operation that creates a
          new data node.";
     }
     bit read {
       description
         "Any protocol operation or notification that
          returns the value of a data node.";
     }
     bit update {
       description
         "Any protocol operation that alters an existing
          data node.";
     }
     bit delete {
       description
         "Any protocol operation that removes a data node.";
     }
     bit exec {
       description
         "Execution access to the specified protocol operation.";
     }
   }
   description
     "Access operation.";
 }

 typedef group-name-type {
   type string {
     length "1..max";
     pattern '[^\*].*';
   }
   description
     "Name of administrative group to which
      users can be assigned.";
 }

 typedef action-type {
   type enumeration {
     enum permit {
       description
         "Requested action is permitted.";
     }
     enum deny {
       description
         "Requested action is denied.";
     }
   }
   description
     "Action taken by the server when a particular
      rule matches.";
 }

 typedef node-instance-identifier {
   type yang:xpath1.0;
   description
     "Path expression used to represent a special
      data node, action, or notification instance-identifier
      string.

      A node-instance-identifier value is an
      unrestricted YANG instance-identifier expression.

      All the same rules as an instance-identifier apply,
      except that predicates for keys are optional.  If a key
      predicate is missing, then the node-instance-identifier
      represents all possible server instances for that key.

      This XML Path Language (XPath) expression is evaluated in the
      following context:

         o  The set of namespace declarations are those in scope on
            the leaf element where this type is used.

         o  The set of variable bindings contains one variable,
            'USER', which contains the name of the user of the
            current session.

         o  The function library is the core function library, but
            note that due to the syntax restrictions of an
            instance-identifier, no functions are allowed.

         o  The context node is the root node in the data tree.

      The accessible tree includes actions and notifications tied
      to data nodes.";
 }

 /*
  * Data definition statements
  */

 container nacm {
   nacm:default-deny-all;

   description
     "Parameters for NETCONF access control model.";

   leaf enable-nacm {
     type boolean;
     default "true";
     description
       "Enables or disables all NETCONF access control
        enforcement.  If 'true', then enforcement
        is enabled.  If 'false', then enforcement
        is disabled.";
   }

   leaf read-default {
     type action-type;
     default "permit";
     description
       "Controls whether read access is granted if
        no appropriate rule is found for a
        particular read request.";
   }

   leaf write-default {
     type action-type;
     default "deny";
     description
       "Controls whether create, update, or delete access
        is granted if no appropriate rule is found for a
        particular write request.";
   }

   leaf exec-default {
     type action-type;
     default "permit";
     description
       "Controls whether exec access is granted if no appropriate
        rule is found for a particular protocol operation request.";
   }

   leaf enable-external-groups {
     type boolean;
     default "true";
     description
       "Controls whether the server uses the groups reported by the
        NETCONF transport layer when it assigns the user to a set of
        NACM groups.  If this leaf has the value 'false', any group
        names reported by the transport layer are ignored by the
        server.";
   }

   leaf denied-operations {
     type yang:zero-based-counter32;
     config false;
     mandatory true;
     description
       "Number of times since the server last restarted that a
        protocol operation request was denied.";
   }

   leaf denied-data-writes {
     type yang:zero-based-counter32;
     config false;
     mandatory true;
     description
       "Number of times since the server last restarted that a
        protocol operation request to alter
        a configuration datastore was denied.";
   }

   leaf denied-notifications {
     type yang:zero-based-counter32;
     config false;
     mandatory true;
     description
       "Number of times since the server last restarted that
        a notification was dropped for a subscription because
        access to the event type was denied.";
   }

   container groups {
     description
       "NETCONF access control groups.";

     list group {
       key name;

       description
         "One NACM group entry.  This list will only contain
          configured entries, not any entries learned from
          any transport protocols.";

       leaf name {
         type group-name-type;
         description
           "Group name associated with this entry.";
       }

       leaf-list user-name {
         type user-name-type;
         description
           "Each entry identifies the username of
            a member of the group associated with
            this entry.";
       }
     }
   }

   list rule-list {
     key name;
     ordered-by user;
     description
       "An ordered collection of access control rules.";

     leaf name {
       type string {
         length "1..max";
       }
       description
         "Arbitrary name assigned to the rule-list.";
     }
     leaf-list group {
       type union {
         type matchall-string-type;
         type group-name-type;
       }
       description
         "List of administrative groups that will be
          assigned the associated access rights
          defined by the 'rule' list.

          The string '*' indicates that all groups apply to the
          entry.";
     }

     list rule {
       key name;
       ordered-by user;
       description
         "One access control rule.

          Rules are processed in user-defined order until a match is
          found.  A rule matches if 'module-name', 'rule-type', and
          'access-operations' match the request.  If a rule
          matches, the 'action' leaf determines whether or not
          access is granted.";

       leaf name {
         type string {
           length "1..max";
         }
         description
           "Arbitrary name assigned to the rule.";
       }

       leaf module-name {
         type union {
           type matchall-string-type;
           type string;
         }
         default "*";
         description
           "Name of the module associated with this rule.

            This leaf matches if it has the value '*' or if the
            object being accessed is defined in the module with the
            specified module name.";
       }
       choice rule-type {
         description
           "This choice matches if all leafs present in the rule
            match the request.  If no leafs are present, the
            choice matches all requests.";
         case protocol-operation {
           leaf rpc-name {
             type union {
               type matchall-string-type;
               type string;
             }
             description
               "This leaf matches if it has the value '*' or if
                its value equals the requested protocol operation
                name.";
           }
         }
         case notification {
           leaf notification-name {
             type union {
               type matchall-string-type;
               type string;
             }
             description
               "This leaf matches if it has the value '*' or if its
                value equals the requested notification name.";
           }
         }

         case data-node {
           leaf path {
             type node-instance-identifier;
             mandatory true;
             description
               "Data node instance-identifier associated with the
                data node, action, or notification controlled by
                this rule.

                Configuration data or state data
                instance-identifiers start with a top-level
                data node.  A complete instance-identifier is
                required for this type of path value.

                The special value '/' refers to all possible
                datastore contents.";
           }
         }
       }

       leaf access-operations {
         type union {
           type matchall-string-type;
           type access-operations-type;
         }
         default "*";
         description
           "Access operations associated with this rule.

            This leaf matches if it has the value '*' or if the
            bit corresponding to the requested operation is set.";
       }

       leaf action {
         type action-type;
         mandatory true;
         description
           "The access control action associated with the
            rule.  If a rule has been determined to match a
            particular request, then this object is used
            to determine whether to permit or deny the
            request.";
       }

       leaf comment {
         type string;
         description
           "A textual description of the access rule.";
       }
     }
   }
 }
}
&lt;CODE ENDS&gt;
</pre><a href="#section-3.5.2-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-4">
      <h2 id="name-iana-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-4-1">This document reuses the URI for "ietf-netconf-acm" in the "IETF XML Registry".<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">This document updates the module registration in the "YANG Module Names" registry to reference this
RFC instead of RFC 6536 for "ietf-netconf-acm".  Following the format in <span>[<a href="#RFC6020" class="xref">RFC6020</a>]</span>, the following
has been registered.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4-3">
<pre>Name: ietf-netconf-acm
Namespace: urn:ietf:params:xml:ns:yang:ietf-netconf-acm
Prefix: nacm
Reference: RFC 8341
</pre><a href="#section-4-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-5-1">The YANG module specified in this document defines a schema for data that is designed to be accessed
via network management protocols such as NETCONF <span>[<a href="#RFC6241" class="xref">RFC6241</a>]</span> or RESTCONF <span>[<a href="#RFC8040" class="xref">RFC8040</a>]</span>.  The lowest
NETCONF layer is the secure transport layer, and the mandatory-to-implement secure transport is
Secure Shell (SSH) <span>[<a href="#RFC6242" class="xref">RFC6242</a>]</span>.  The lowest RESTCONF layer is HTTPS, and the mandatory-to-implement
secure transport is TLS <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The NETCONF access control model [RFC8341] provides the means to restrict access for particular
NETCONF or RESTCONF users to a preconfigured subset of all available NETCONF or RESTCONF protocol
operations and content.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">There is a risk related to the lack of access control enforcement for the RESTCONF OPTIONS and PATCH
methods.  The risk here is that the response to OPTIONS and PATCH may vary based on the presence or
absence of a resource corresponding to the URL's path.  If this is the case, then it can be used to
trivially probe for the presence or absence of values within a tree.  Therefore, a server
<span class="bcp14">MUST NOT</span> vary<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">its responses based on the existence of the underlying resource, which would indicate the presence
or absence of resource instances. In particular, servers should not expose any instance information
before ensuring that the client has the necessary access permissions to obtain that information.  In
such cases, servers are expected to always return the "access-denied" error response.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">There are a number of data nodes defined in this YANG module that are writable/creatable/deletable
(i.e., config true, which is the default).  These data nodes may be considered sensitive or
vulnerable in some network environments.  Write operations (e.g., edit-config) to these data nodes
without proper protection can have a negative effect on network operations.  These are the subtrees
and data nodes and their sensitivity/vulnerability:<a href="#section-5-5" class="pilcrow">¶</a></p>
<ul>
<li id="section-5-6.1">
          <p id="section-5-6.1.1">/nacm: The entire /nacm subtree is related to security.  Refer to the following sections for more
details.<a href="#section-5-6.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-5-7">This section highlights the issues for an administrator to consider
when configuring a NETCONF server with the NACM.<a href="#section-5-7" class="pilcrow">¶</a></p>
<div id="nacm-configuration-and-monitoring-considerations">
<section id="section-5.1">
        <h3 id="name-nacm-configuration-and-moni">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-nacm-configuration-and-moni" class="section-name selfRef">NACM Configuration and Monitoring Considerations</a>
        </h3>
<p id="section-5.1-1">Configuration of the access control system is highly sensitive to system security.  A server may
choose not to allow any user configuration to some portions of it, such as the global security level
or the groups that allowed access to system resources.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">By default, NACM enforcement is enabled.  By default, "read" access to all datastore contents is
enabled (unless "nacm:default-deny-all" is specified for the data definition), and "exec" access is
enabled for safe protocol operations.  An administrator needs to ensure that the NACM is enabled and
also decide if the default access parameters are set appropriately.  Make sure that the following
data nodes are properly configured:<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.1-3.1">
            <p id="section-5.1-3.1.1">/nacm/enable-nacm (default "true")<a href="#section-5.1-3.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5.1-3.2">
            <p id="section-5.1-3.2.1">/nacm/read-default (default "permit")<a href="#section-5.1-3.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5.1-3.3">
            <p id="section-5.1-3.3.1">/nacm/write-default (default "deny")<a href="#section-5.1-3.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5.1-3.4">
            <p id="section-5.1-3.4.1">/nacm/exec-default (default "permit")<a href="#section-5.1-3.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-5.1-4">An administrator needs to restrict write access to all configurable objects within this data model.<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<p id="section-5.1-5">If write access is allowed for configuration of access control rules, then care needs to be taken
not to disrupt the access control enforcement.  For example, if the NACM access control rules are
edited directly within the running configuration datastore (i.e., :writable-running capability is
supported and used), then care needs to be taken not to allow unintended access while the edits are
being done.<a href="#section-5.1-5" class="pilcrow">¶</a></p>
<p id="section-5.1-6">An administrator needs to make sure that the translation from a transport- or
implementation-dependent user identity to a NACM username is unique and correct.  This requirement
is specified in detail in Section 2.2 of <span>[<a href="#RFC6241" class="xref">RFC6241</a>]</span>.<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<p id="section-5.1-7">An administrator needs to be aware that the YANG data structures representing access control rules
(/nacm/rule-list and /nacm/rule-list/rule) are ordered by the client.  The server will evaluate the
access control rules according to their relative conceptual order within the running configuration
datastore.<a href="#section-5.1-7" class="pilcrow">¶</a></p>
<p id="section-5.1-8">Note that the /nacm/groups data structure contains the administrative group names used by the
server.  These group names may be configured locally and/or provided through an external protocol,
such as RADIUS <span>[<a href="#RFC2865" class="xref">RFC2865</a>]</span> <span>[<a href="#RFC5607" class="xref">RFC5607</a>]</span>.<a href="#section-5.1-8" class="pilcrow">¶</a></p>
<p id="section-5.1-9">An administrator needs to be aware of the security properties of any external protocol used by the
transport layer to determine group names.  For example, if this protocol does not protect against
man-in-the-middle attacks, an attacker might be able to inject group names that are configured in
the NACM so that a user gets more permissions than it should.  In such cases, the administrator may
wish to disable the usage of such group names by setting /nacm/enable-external-groups to "false".<a href="#section-5.1-9" class="pilcrow">¶</a></p>
<p id="section-5.1-10">Some of the readable data nodes in this YANG module may be considered sensitive or vulnerable in
some network environments.  It is thus important to control read access (e.g., via get, get-config,
or notification) to these data nodes.  These are the subtrees and data nodes and their
sensitivity/vulnerability:<a href="#section-5.1-10" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.1-11.1">
            <p id="section-5.1-11.1.1">/nacm/enable-nacm<a href="#section-5.1-11.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5.1-11.2">
            <p id="section-5.1-11.2.1">/nacm/read-default<a href="#section-5.1-11.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5.1-11.3">
            <p id="section-5.1-11.3.1">/nacm/write-default<a href="#section-5.1-11.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5.1-11.4">
            <p id="section-5.1-11.4.1">/nacm/exec-default<a href="#section-5.1-11.4.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5.1-11.5">
            <p id="section-5.1-11.5.1">/nacm/enable-external-groups<a href="#section-5.1-11.5.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5.1-11.6">
            <p id="section-5.1-11.6.1">/nacm/groups<a href="#section-5.1-11.6.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5.1-11.7">
            <p id="section-5.1-11.7.1">/nacm/rule-list<a href="#section-5.1-11.7.1" class="pilcrow">¶</a></p>
</li>
</ul>
<p id="section-5.1-12">An administrator needs to restrict read access to the above-listed objects within this data model,
as they reveal access control configuration that could be considered sensitive.<a href="#section-5.1-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="general-configuration-issues">
<section id="section-5.2">
        <h3 id="name-general-configuration-issue">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-general-configuration-issue" class="section-name selfRef">General Configuration Issues</a>
        </h3>
<p id="section-5.2-1">There is a risk that invocation of non-standard protocol operations will have undocumented side
effects.  An administrator needs to construct access control rules such that the configuration
datastore is protected from such side effects.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">It is possible for a session with some write access (e.g., allowed to invoke &lt;edit-config&gt;), but
without any access to a particular datastore subtree containing sensitive data, to determine the
presence or non-presence of that data.  This can be done by repeatedly issuing some sort of edit
request (create, update, or delete) and possibly receiving "access-denied" errors in response. These
"fishing" attacks can identify the presence or non-presence of specific sensitive data even without
the "error-path" field being present within the &lt;rpc-error&gt; response.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">It may be possible for the set of NETCONF capabilities on the server to change over time.  If so,
then there is a risk that new protocol operations, notifications, and/or datastore content have been
added to the device.  An administrator needs to be sure that the access control rules are correct
for the new content in this case. Mechanisms to detect NETCONF capability changes on a specific
device are outside the scope of this document.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">It is possible that the data model definition itself (e.g., a YANG when-stmt) will help an
unauthorized session determine the presence or even value of sensitive data nodes by examining the
presence and values of different data nodes.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">It is possible that the data model definition itself (e.g., a YANG when-stmt or choice-stmt) will
allow a session to implicitly create or delete nodes that the session does not have write access to
as an implicit side effect from the processing of an allowed &lt;edit-config&gt; operation.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<p id="section-5.2-6">There is a risk that non-standard protocol operations, or even the standard &lt;get&gt; protocol
operation, may return data that "aliases" or "copies" sensitive data from a different data object.
There may simply be multiple data model definitions that expose or even configure the same
underlying system instrumentation.<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<p id="section-5.2-7">A data model may contain external keys (e.g., YANG leafref), which expose values from a different
data structure.  An administrator needs to be aware of sensitive data models that contain leafref
nodes.  This entails finding all the leafref objects that "point" at the sensitive data (i.e.,
"path-stmt" values) that implicitly or explicitly includes the sensitive data node.<a href="#section-5.2-7" class="pilcrow">¶</a></p>
<p id="section-5.2-8">It is beyond the scope of this document to define access control enforcement procedures for
underlying device instrumentation that may exist to support the NETCONF server operation.  An
administrator can identify each protocol operation that the server provides and decide if it needs
any access control applied to it.<a href="#section-5.2-8" class="pilcrow">¶</a></p>
<p id="section-5.2-9">This document incorporates the optional use of a recovery session mechanism, which can be used to
bypass access control enforcement in emergencies such as NACM configuration errors that disable all
access to the server.  The configuration and identification of such a recovery session mechanism are
implementation specific and are outside the scope of this document.  An administrator needs to be
aware of any recovery session mechanisms available on the device and make sure that they are used
appropriately.<a href="#section-5.2-9" class="pilcrow">¶</a></p>
<p id="section-5.2-10">It is possible for a session to disrupt configuration management, even without any write access to
the configuration, by locking the datastore.  This may be done to ensure that all or part of the
configuration remains stable while it is being retrieved, or it may be done as a "denial-of-service"
attack.  There is no way for the server to know the difference.  An administrator may wish to
restrict "exec" access to the following protocol operations:<a href="#section-5.2-10" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.2-11.1">
            <p id="section-5.2-11.1.1">&lt;lock&gt;<a href="#section-5.2-11.1.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5.2-11.2">
            <p id="section-5.2-11.2.1">&lt;unlock&gt;<a href="#section-5.2-11.2.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5.2-11.3">
            <p id="section-5.2-11.3.1">&lt;partial-lock&gt;<a href="#section-5.2-11.3.1" class="pilcrow">¶</a></p>
</li>
<li id="section-5.2-11.4">
            <p id="section-5.2-11.4.1">&lt;partial-unlock&gt;<a href="#section-5.2-11.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</section>
</div>
<div id="data-model-design-considerations">
<section id="section-5.3">
        <h3 id="name-data-model-design-considera">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-data-model-design-considera" class="section-name selfRef">Data Model Design Considerations</a>
        </h3>
<p id="section-5.3-1">Designers need to clearly identify any sensitive data, notifications, or protocol operations defined
within a YANG module.  For such definitions, a "nacm:default-deny-write" or "nacm:default-deny-all"
statement ought to be present, in addition to a clear description of the security risks.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">Protocol operations need to be properly documented by the data model designer so that it is clear to
administrators what data nodes (if any) are affected by the protocol operation and what information
(if any) is returned in the &lt;rpc-reply&gt; message.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">Data models ought to be designed so that different access levels for input parameters to protocol
operations are not required.  The use of generic protocol operations should be avoided, and if
different access levels are needed, separate protocol operations should be defined instead.<a href="#section-5.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-6">
      <h2 id="name-normative-references">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC5246">[RFC5246]</dt>
<dd>
<span class="refAuthor">Dierks, T.</span><span class="refAuthor"> and E. Rescorla</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.2"</span>, <span class="seriesInfo">RFC 5246</span>, <span class="seriesInfo">DOI 10.17487/RFC5246</span>, <time datetime="2008-08">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5246">https://www.rfc-editor.org/info/rfc5246</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="W3C.REC-xml-20081126">[W3C.REC-xml-20081126]</dt>
<dd>
<span class="refAuthor">Bray, T.</span><span class="refAuthor">, Paoli, J.</span><span class="refAuthor">, Sperberg-McQueen, M.</span><span class="refAuthor">, Maler, E.</span><span class="refAuthor">, and F. Yergeau</span>, <span class="refTitle">"Extensible Markup Language (XML) 1.0 (Fifth Edition)"</span>, <span class="seriesInfo">World Wide Web Consortium Recommendation REC-xml-20081126</span>, <time datetime="2008-11-26">26 November 2008</time>, <span>&lt;<a href="http://www.w3.org/TR/2008/REC-xml-20081126">http://www.w3.org/TR/2008/REC-xml-20081126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8342">[RFC8342]</dt>
<dd>
<span class="refAuthor">Bjorklund, M.</span><span class="refAuthor">, Schoenwaelder, J.</span><span class="refAuthor">, Shafer, P.</span><span class="refAuthor">, Watsen, K.</span><span class="refAuthor">, and R. Wilton</span>, <span class="refTitle">"Network Management Datastore Architecture (NMDA)"</span>, <span class="seriesInfo">RFC 8342</span>, <span class="seriesInfo">DOI 10.17487/RFC8342</span>, <time datetime="2018-03">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8342">https://www.rfc-editor.org/info/rfc8342</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5277">[RFC5277]</dt>
<dd>
<span class="refAuthor">Chisholm, S.</span><span class="refAuthor"> and H. Trevino</span>, <span class="refTitle">"NETCONF Event Notifications"</span>, <span class="seriesInfo">RFC 5277</span>, <span class="seriesInfo">DOI 10.17487/RFC5277</span>, <time datetime="2008-07">July 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5277">https://www.rfc-editor.org/info/rfc5277</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
<dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7950">[RFC7950]</dt>
<dd>
<span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refTitle">"The YANG 1.1 Data Modeling Language"</span>, <span class="seriesInfo">RFC 7950</span>, <span class="seriesInfo">DOI 10.17487/RFC7950</span>, <time datetime="2016-08">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7950">https://www.rfc-editor.org/info/rfc7950</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7230">[RFC7230]</dt>
<dd>
<span class="refAuthor">Fielding, R., Ed.</span><span class="refAuthor"> and J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Message Syntax and Routing"</span>, <span class="seriesInfo">RFC 7230</span>, <span class="seriesInfo">DOI 10.17487/RFC7230</span>, <time datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7230">https://www.rfc-editor.org/info/rfc7230</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6991">[RFC6991]</dt>
<dd>
<span class="refAuthor">Schoenwaelder, J., Ed.</span>, <span class="refTitle">"Common YANG Data Types"</span>, <span class="seriesInfo">RFC 6991</span>, <span class="seriesInfo">DOI 10.17487/RFC6991</span>, <time datetime="2013-07">July 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6991">https://www.rfc-editor.org/info/rfc6991</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6020">[RFC6020]</dt>
<dd>
<span class="refAuthor">Bjorklund, M., Ed.</span>, <span class="refTitle">"YANG - A Data Modeling Language for the Network Configuration Protocol (NETCONF)"</span>, <span class="seriesInfo">RFC 6020</span>, <span class="seriesInfo">DOI 10.17487/RFC6020</span>, <time datetime="2010-10">October 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6020">https://www.rfc-editor.org/info/rfc6020</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6242">[RFC6242]</dt>
<dd>
<span class="refAuthor">Wasserman, M.</span>, <span class="refTitle">"Using the NETCONF Protocol over Secure Shell (SSH)"</span>, <span class="seriesInfo">RFC 6242</span>, <span class="seriesInfo">DOI 10.17487/RFC6242</span>, <time datetime="2011-06">June 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6242">https://www.rfc-editor.org/info/rfc6242</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6241">[RFC6241]</dt>
<dd>
<span class="refAuthor">Enns, R., Ed.</span><span class="refAuthor">, Bjorklund, M., Ed.</span><span class="refAuthor">, Schoenwaelder, J., Ed.</span><span class="refAuthor">, and A. Bierman, Ed.</span>, <span class="refTitle">"Network Configuration Protocol (NETCONF)"</span>, <span class="seriesInfo">RFC 6241</span>, <span class="seriesInfo">DOI 10.17487/RFC6241</span>, <time datetime="2011-06">June 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6241">https://www.rfc-editor.org/info/rfc6241</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8040">[RFC8040]</dt>
<dd>
<span class="refAuthor">Bierman, A.</span><span class="refAuthor">, Bjorklund, M.</span><span class="refAuthor">, and K. Watsen</span>, <span class="refTitle">"RESTCONF Protocol"</span>, <span class="seriesInfo">RFC 8040</span>, <span class="seriesInfo">DOI 10.17487/RFC8040</span>, <time datetime="2017-01">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8040">https://www.rfc-editor.org/info/rfc8040</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-7">
      <h2 id="name-informative-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="RFC2865">[RFC2865]</dt>
<dd>
<span class="refAuthor">Rigney, C.</span><span class="refAuthor">, Willens, S.</span><span class="refAuthor">, Rubens, A.</span><span class="refAuthor">, and W. Simpson</span>, <span class="refTitle">"Remote Authentication Dial In User Service (RADIUS)"</span>, <span class="seriesInfo">RFC 2865</span>, <span class="seriesInfo">DOI 10.17487/RFC2865</span>, <time datetime="2000-06">June 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2865">https://www.rfc-editor.org/info/rfc2865</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5607">[RFC5607]</dt>
<dd>
<span class="refAuthor">Nelson, D.</span><span class="refAuthor"> and G. Weber</span>, <span class="refTitle">"Remote Authentication Dial-In User Service (RADIUS) Authorization for Network Access Server (NAS) Management"</span>, <span class="seriesInfo">RFC 5607</span>, <span class="seriesInfo">DOI 10.17487/RFC5607</span>, <time datetime="2009-07">July 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5607">https://www.rfc-editor.org/info/rfc5607</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="YANG-SEC">[YANG-SEC]</dt>
<dd>
<span class="refAuthor">IETF</span>, <span class="refTitle">"YANG Security Guidelines"</span>, <time></time>, <span>&lt;<a href="https://trac.ietf.org/trac/ops/wiki/yang-security-guidelines">https://trac.ietf.org/trac/ops/wiki/yang-security-guidelines</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="usage-examples">
<section id="section-appendix.a">
      <h2 id="name-usage-examples">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-usage-examples" class="section-name selfRef">Usage Examples</a>
      </h2>
<p id="section-appendix.a-1">The following XML <span>[<a href="#W3C.REC-xml-20081126" class="xref">W3C.REC-xml-20081126</a>]</span> snippets are provided as examples only, to demonstrate
how the NACM can be configured to perform some access control tasks.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<div id="groups-example">
<section id="section-a.1">
        <h2 id="name-groups-example">
<a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-groups-example" class="section-name selfRef">&lt;groups&gt; Example</a>
        </h2>
<p id="section-a.1-1">There needs to be at least one &lt;group&gt; entry in order for any of the access control rules to be
useful.<a href="#section-a.1-1" class="pilcrow">¶</a></p>
<p id="section-a.1-2">The following XML shows arbitrary groups and is not intended to represent any particular use case.<a href="#section-a.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.1-3">
<pre>&lt;nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm"&gt;
 &lt;groups&gt;
   &lt;group&gt;
     &lt;name&gt;admin&lt;/name&gt;
     &lt;user-name&gt;admin&lt;/user-name&gt;
     &lt;user-name&gt;andy&lt;/user-name&gt;
   &lt;/group&gt;

   &lt;group&gt;
     &lt;name&gt;limited&lt;/name&gt;
     &lt;user-name&gt;wilma&lt;/user-name&gt;
     &lt;user-name&gt;bam-bam&lt;/user-name&gt;
   &lt;/group&gt;

   &lt;group&gt;
     &lt;name&gt;guest&lt;/name&gt;
     &lt;user-name&gt;guest&lt;/user-name&gt;
     &lt;user-name&gt;guest@example.com&lt;/user-name&gt;
   &lt;/group&gt;
 &lt;/groups&gt;
&lt;/nacm&gt;
</pre><a href="#section-a.1-3" class="pilcrow">¶</a>
</div>
<p id="section-a.1-4">This example shows three groups:<a href="#section-a.1-4" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-a.1-5">
          <dt id="section-a.1-5.1">admin:</dt>
<dd id="section-a.1-5.2">
            <p id="section-a.1-5.2.1">The "admin" group contains two users named "admin" and "andy".<a href="#section-a.1-5.2.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-a.1-5.3">limited:</dt>
<dd id="section-a.1-5.4">
            <p id="section-a.1-5.4.1">The "limited" group contains two users named "wilma" and "bam-bam".<a href="#section-a.1-5.4.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-a.1-5.5">guest:</dt>
<dd id="section-a.1-5.6">
            <p id="section-a.1-5.6.1">The "guest" group contains two users named "guest" and "guest@example.com".<a href="#section-a.1-5.6.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="module-rule-example">
<section id="section-a.2">
        <h2 id="name-module-rule-example">
<a href="#section-a.2" class="section-number selfRef">A.2. </a><a href="#name-module-rule-example" class="section-name selfRef">Module Rule Example</a>
        </h2>
<p id="section-a.2-1">Module rules are used to control access to all the content defined in a specific module.  A module
rule has the "module-name" leaf set but no nodes from the "rule-type" choice set.<a href="#section-a.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.2-2">
<pre>&lt;nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm"&gt;
 &lt;rule-list&gt;
   &lt;name&gt;guest-acl&lt;/name&gt;
   &lt;group&gt;guest&lt;/group&gt;

   &lt;rule&gt;
     &lt;name&gt;deny-ncm&lt;/name&gt;
     &lt;module-name&gt;ietf-netconf-monitoring&lt;/module-name&gt;
     &lt;access-operations&gt;*&lt;/access-operations&gt;
     &lt;action&gt;deny&lt;/action&gt;
     &lt;comment&gt;
         Do not allow guests any access to the NETCONF
         monitoring information.
     &lt;/comment&gt;
   &lt;/rule&gt;
 &lt;/rule-list&gt;

 &lt;rule-list&gt;
   &lt;name&gt;limited-acl&lt;/name&gt;
   &lt;group&gt;limited&lt;/group&gt;

   &lt;rule&gt;
     &lt;name&gt;permit-ncm&lt;/name&gt;
     &lt;module-name&gt;ietf-netconf-monitoring&lt;/module-name&gt;
     &lt;access-operations&gt;read&lt;/access-operations&gt;
     &lt;action&gt;permit&lt;/action&gt;
     &lt;comment&gt;
         Allow read access to the NETCONF
         monitoring information.
     &lt;/comment&gt;
   &lt;/rule&gt;
   &lt;rule&gt;
     &lt;name&gt;permit-exec&lt;/name&gt;
     &lt;module-name&gt;*&lt;/module-name&gt;
     &lt;access-operations&gt;exec&lt;/access-operations&gt;
     &lt;action&gt;permit&lt;/action&gt;
     &lt;comment&gt;
         Allow invocation of the
         supported server operations.
     &lt;/comment&gt;
   &lt;/rule&gt;
 &lt;/rule-list&gt;

 &lt;rule-list&gt;
   &lt;name&gt;admin-acl&lt;/name&gt;
   &lt;group&gt;admin&lt;/group&gt;

   &lt;rule&gt;
     &lt;name&gt;permit-all&lt;/name&gt;
     &lt;module-name&gt;*&lt;/module-name&gt;
     &lt;access-operations&gt;*&lt;/access-operations&gt;
     &lt;action&gt;permit&lt;/action&gt;
     &lt;comment&gt;
         Allow the 'admin' group complete access to all
         operations and data.
     &lt;/comment&gt;
   &lt;/rule&gt;
 &lt;/rule-list&gt;
&lt;/nacm&gt;
</pre><a href="#section-a.2-2" class="pilcrow">¶</a>
</div>
<p id="section-a.2-3">This example shows four module rules:<a href="#section-a.2-3" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-a.2-4">
          <dt id="section-a.2-4.1">deny-ncm:</dt>
<dd id="section-a.2-4.2">
            <p id="section-a.2-4.2.1">This rule prevents the "guest" group from reading any monitoring information in the
"ietf-netconf-monitoring" YANG module.<a href="#section-a.2-4.2.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-a.2-4.3">permit-ncm:</dt>
<dd id="section-a.2-4.4">
            <p id="section-a.2-4.4.1">This rule allows the "limited" group to read the "ietf-netconf-monitoring" YANG module.<a href="#section-a.2-4.4.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-a.2-4.5">permit-exec:</dt>
<dd id="section-a.2-4.6">
            <p id="section-a.2-4.6.1">This rule allows the "limited" group to invoke any protocol operation supported by the server.<a href="#section-a.2-4.6.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-a.2-4.7">permit-all:</dt>
<dd id="section-a.2-4.8">
            <p id="section-a.2-4.8.1">This rule allows the "admin" group complete access to all content in the server.  No subsequent
rule will match for the "admin" group because of this module rule.<a href="#section-a.2-4.8.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="protocol-operation-rule-example">
<section id="section-a.3">
        <h2 id="name-protocol-operation-rule-exa">
<a href="#section-a.3" class="section-number selfRef">A.3. </a><a href="#name-protocol-operation-rule-exa" class="section-name selfRef">Protocol Operation Rule Example</a>
        </h2>
<p id="section-a.3-1">Protocol operation rules are used to control access to a specific protocol operation.<a href="#section-a.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.3-2">
<pre>&lt;nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm"&gt;
 &lt;rule-list&gt;
   &lt;name&gt;guest-limited-acl&lt;/name&gt;
   &lt;group&gt;limited&lt;/group&gt;
   &lt;group&gt;guest&lt;/group&gt;

   &lt;rule&gt;
     &lt;name&gt;deny-kill-session&lt;/name&gt;
     &lt;module-name&gt;ietf-netconf&lt;/module-name&gt;
     &lt;rpc-name&gt;kill-session&lt;/rpc-name&gt;
     &lt;access-operations&gt;exec&lt;/access-operations&gt;
     &lt;action&gt;deny&lt;/action&gt;
     &lt;comment&gt;
       Do not allow the 'limited' group or the 'guest' group
       to kill another session.
     &lt;/comment&gt;
   &lt;/rule&gt;
   &lt;rule&gt;
     &lt;name&gt;deny-delete-config&lt;/name&gt;
     &lt;module-name&gt;ietf-netconf&lt;/module-name&gt;
     &lt;rpc-name&gt;delete-config&lt;/rpc-name&gt;
     &lt;access-operations&gt;exec&lt;/access-operations&gt;
     &lt;action&gt;deny&lt;/action&gt;
     &lt;comment&gt;
       Do not allow the 'limited' group or the 'guest' group
       to delete any configurations.
     &lt;/comment&gt;
   &lt;/rule&gt;
 &lt;/rule-list&gt;

 &lt;rule-list&gt;
   &lt;name&gt;limited-acl&lt;/name&gt;
   &lt;group&gt;limited&lt;/group&gt;

   &lt;rule&gt;
     &lt;name&gt;permit-edit-config&lt;/name&gt;
     &lt;module-name&gt;ietf-netconf&lt;/module-name&gt;
     &lt;rpc-name&gt;edit-config&lt;/rpc-name&gt;
     &lt;access-operations&gt;exec&lt;/access-operations&gt;
     &lt;action&gt;permit&lt;/action&gt;
     &lt;comment&gt;
       Allow the 'limited' group to edit the configuration.
     &lt;/comment&gt;
   &lt;/rule&gt;
 &lt;/rule-list&gt;
&lt;/nacm&gt;
</pre><a href="#section-a.3-2" class="pilcrow">¶</a>
</div>
<p id="section-a.3-3">This example shows three protocol operation rules:<a href="#section-a.3-3" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-a.3-4">
          <dt id="section-a.3-4.1">deny-kill-session:</dt>
<dd id="section-a.3-4.2">
            <p id="section-a.3-4.2.1">This rule prevents the "limited" group or the "guest" group from invoking the NETCONF
&lt;kill-session&gt; protocol operation.<a href="#section-a.3-4.2.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-a.3-4.3">deny-delete-config:</dt>
<dd id="section-a.3-4.4">
            <p id="section-a.3-4.4.1">This rule prevents the "limited" group or the "guest" group from invoking the NETCONF
&lt;delete-config&gt; protocol operation.<a href="#section-a.3-4.4.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-a.3-4.5">permit-edit-config:</dt>
<dd id="section-a.3-4.6">
            <p id="section-a.3-4.6.1">This rule allows the "limited" group to invoke the NETCONF &lt;edit-config&gt; protocol operation.
This rule will have no real effect unless the "exec-default" leaf is set to "deny".<a href="#section-a.3-4.6.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="data-node-rule-example">
<section id="section-a.4">
        <h2 id="name-data-node-rule-example">
<a href="#section-a.4" class="section-number selfRef">A.4. </a><a href="#name-data-node-rule-example" class="section-name selfRef">Data Node Rule Example</a>
        </h2>
<p id="section-a.4-1">Data node rules are used to control access to specific (config and non-config) data nodes within the
NETCONF content provided by the server.<a href="#section-a.4-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.4-2">
<pre>&lt;nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm"&gt;
 &lt;rule-list&gt;
   &lt;name&gt;guest-acl&lt;/name&gt;
   &lt;group&gt;guest&lt;/group&gt;

   &lt;rule&gt;
     &lt;name&gt;deny-nacm&lt;/name&gt;
     &lt;path xmlns:n="urn:ietf:params:xml:ns:yang:ietf-netconf-acm"&gt;
       /n:nacm
     &lt;/path&gt;
     &lt;access-operations&gt;*&lt;/access-operations&gt;
     &lt;action&gt;deny&lt;/action&gt;
     &lt;comment&gt;
       Deny the 'guest' group any access to the /nacm data.
     &lt;/comment&gt;
   &lt;/rule&gt;
 &lt;/rule-list&gt;

 &lt;rule-list&gt;
   &lt;name&gt;limited-acl&lt;/name&gt;
   &lt;group&gt;limited&lt;/group&gt;

   &lt;rule&gt;
     &lt;name&gt;permit-acme-config&lt;/name&gt;
     &lt;path xmlns:acme="http://example.com/ns/netconf"&gt;
       /acme:acme-netconf/acme:config-parameters
     &lt;/path&gt;
     &lt;access-operations&gt;
       read create update delete
     &lt;/access-operations&gt;
     &lt;action&gt;permit&lt;/action&gt;
     &lt;comment&gt;
       Allow the 'limited' group complete access to the acme
       NETCONF configuration parameters.  Showing long form
       of 'access-operations' instead of shorthand.
     &lt;/comment&gt;
   &lt;/rule&gt;
 &lt;/rule-list&gt;

 &lt;rule-list&gt;
   &lt;name&gt;guest-limited-acl&lt;/name&gt;
   &lt;group&gt;guest&lt;/group&gt;
   &lt;group&gt;limited&lt;/group&gt;

   &lt;rule&gt;
     &lt;name&gt;permit-dummy-interface&lt;/name&gt;
     &lt;path xmlns:acme="http://example.com/ns/itf"&gt;
       /acme:interfaces/acme:interface[acme:name='dummy']
     &lt;/path&gt;
     &lt;access-operations&gt;read update&lt;/access-operations&gt;
     &lt;action&gt;permit&lt;/action&gt;
     &lt;comment&gt;
       Allow the 'limited' and 'guest' groups read
       and update access to the dummy interface.
     &lt;/comment&gt;
   &lt;/rule&gt;
 &lt;/rule-list&gt;

 &lt;rule-list&gt;
   &lt;name&gt;admin-acl&lt;/name&gt;
   &lt;group&gt;admin&lt;/group&gt;
   &lt;rule&gt;
     &lt;name&gt;permit-interface&lt;/name&gt;
     &lt;path xmlns:acme="http://example.com/ns/itf"&gt;
       /acme:interfaces/acme:interface
     &lt;/path&gt;
     &lt;access-operations&gt;*&lt;/access-operations&gt;
     &lt;action&gt;permit&lt;/action&gt;
     &lt;comment&gt;
       Allow the 'admin' group full access to all acme interfaces.
     &lt;/comment&gt;
   &lt;/rule&gt;
 &lt;/rule-list&gt;
&lt;/nacm&gt;
</pre><a href="#section-a.4-2" class="pilcrow">¶</a>
</div>
<p id="section-a.4-3">This example shows four data node rules:<a href="#section-a.4-3" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-a.4-4">
          <dt id="section-a.4-4.1">deny-nacm:</dt>
<dd id="section-a.4-4.2">
            <p id="section-a.4-4.2.1">This rule denies the "guest" group any access to the /nacm subtree.<a href="#section-a.4-4.2.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-a.4-4.3">permit-acme-config:</dt>
<dd id="section-a.4-4.4">
            <p id="section-a.4-4.4.1">This rule gives the "limited" group read-write access to the acme &lt;config-parameters&gt;.<a href="#section-a.4-4.4.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-a.4-4.5">permit-dummy-interface:</dt>
<dd id="section-a.4-4.6">
            <p id="section-a.4-4.6.1">This rule gives the "limited" and "guest" groups read-update access to the acme &lt;interface&gt;
entry named "dummy".  This entry cannot be created or deleted by these groups; it can only be
altered.<a href="#section-a.4-4.6.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
<dt id="section-a.4-4.7">permit-interface:</dt>
<dd id="section-a.4-4.8">
            <p id="section-a.4-4.8.1">This rule gives the "admin" group read-write access to all acme &lt;interface&gt; entries.<a href="#section-a.4-4.8.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="notification-rule-example">
<section id="section-a.5">
        <h2 id="name-notification-rule-example">
<a href="#section-a.5" class="section-number selfRef">A.5. </a><a href="#name-notification-rule-example" class="section-name selfRef">Notification Rule Example</a>
        </h2>
<p id="section-a.5-1">Notification rules are used to control access to a specific notification event type.<a href="#section-a.5-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-a.5-2">
<pre>&lt;nacm xmlns="urn:ietf:params:xml:ns:yang:ietf-netconf-acm"&gt;
 &lt;rule-list&gt;
   &lt;name&gt;sys-acl&lt;/name&gt;
   &lt;group&gt;limited&lt;/group&gt;
   &lt;group&gt;guest&lt;/group&gt;

   &lt;rule&gt;
     &lt;name&gt;deny-config-change&lt;/name&gt;
     &lt;module-name&gt;acme-system&lt;/module-name&gt;
     &lt;notification-name&gt;sys-config-change&lt;/notification-name&gt;
     &lt;access-operations&gt;read&lt;/access-operations&gt;
     &lt;action&gt;deny&lt;/action&gt;
     &lt;comment&gt;
       Do not allow the 'guest' group or the 'limited' group
       to receive config change events.
     &lt;/comment&gt;
   &lt;/rule&gt;
 &lt;/rule-list&gt;
&lt;/nacm&gt;
</pre><a href="#section-a.5-2" class="pilcrow">¶</a>
</div>
<p id="section-a.5-3">This example shows one notification rule:<a href="#section-a.5-3" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-a.5-4">
          <dt id="section-a.5-4.1">deny-config-change:</dt>
<dd id="section-a.5-4.2">
            <p id="section-a.5-4.2.1">This rule prevents the "limited" group or the "guest" group from receiving the acme
&lt;sys-config-change&gt; event type.<a href="#section-a.5-4.2.1" class="pilcrow">¶</a></p>
</dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Andy Bierman</span></div>
<div dir="auto" class="left"><span class="org">YumaWorks</span></div>
<div dir="auto" class="left"><span class="street-address">685 Cochran St.</span></div>
<div dir="auto" class="left">
<span class="locality">Simi Valley</span>,  <span class="postal-code">CA 93065</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:andy@yumaworks.com" class="email">andy@yumaworks.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Martin Bjorklund</span></div>
<div dir="auto" class="left"><span class="org">Tail-f Systems</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mbj@tail-f.com" class="email">mbj@tail-f.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
